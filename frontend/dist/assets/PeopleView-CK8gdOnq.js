import{_ as F,d as k,c as A,e as B,f as x,w as l,C as E,o as n,b as a,h as c,a as i,j as p,D as R,i as y,u as I,l as _,t as v,F as O,p as U,m as Y,n as Z,k as u,E as j,q as G,G as q}from"./main-BUattiJr.js";import{Q as H}from"./QSelect-D_7hzanl.js";import{Q as J}from"./QSpinnerDots-C2No3ue-.js";import{Q as D}from"./QTooltip-CoLS9g1J.js";import{f as K,u as W,_ as X,a as ee,Q as te,b as oe}from"./NavigationDrawer-CuUZiH8A.js";import{u as ae}from"./people-dIeVvlE2.js";import"./QChip-bPL42vie.js";import"./QItemLabel-C8FJA7k9.js";const se={class:"row items-center q-mb-lg"},le={class:"row q-col-gutter-md q-mb-lg"},ne={class:"col-12 col-md-8"},re={class:"col-12 col-md-4"},ie={key:0,class:"text-center q-pa-lg"},ce={key:1,class:"text-center q-pa-xl"},de={class:"text-h6 text-grey-7 q-mt-md"},ue={key:2,class:"row q-col-gutter-md"},me={class:"text-h6 q-mb-xs"},fe={key:0,class:"text-caption text-grey-7 q-mb-sm"},pe={key:1,class:"text-body2 text-grey-8 q-mb-sm"},ye={key:3,class:"text-caption text-grey-6"},_e={__name:"PeopleView",setup(ve){const h=E(),m=W(),g=ae(),w=k(!1),d=k(""),C=k("name"),$=[{label:"Name (A-Z)",value:"name"},{label:"Name (Z-A)",value:"-name"},{label:"Recently Contacted",value:"-last_contacted"},{label:"Least Recently Contacted",value:"last_contacted"}],Q=A(()=>{let o=[...g.getPeopleList];if(d.value){const e=d.value.toLowerCase().trim();o=o.filter(t=>t.name.toLowerCase().includes(e)||t.name_ext&&t.name_ext.toLowerCase().includes(e)||t.location&&t.location.toLowerCase().includes(e))}return o.sort((e,t)=>{switch(C.value){case"name":return e.name.localeCompare(t.name);case"-name":return t.name.localeCompare(e.name);case"-last_contacted":return!e.last_contacted&&!t.last_contacted?0:e.last_contacted?t.last_contacted?new Date(t.last_contacted)-new Date(e.last_contacted):-1:1;case"last_contacted":return!e.last_contacted&&!t.last_contacted?0:e.last_contacted?t.last_contacted?new Date(e.last_contacted)-new Date(t.last_contacted):-1:1;default:return 0}}),o}),b=async()=>{try{const o=g.peopleCount===1;await g.fetchPeople(o)}catch(o){console.error("Error loading people:",o)}},P=o=>{if(!o)return"Never";const e=new Date(o),r=new Date-e,s=Math.floor(r/(1e3*60*60*24));if(s===0)return"Today";if(s===1)return"Yesterday";if(s<7)return s===1?"1 day ago":`${s} days ago`;if(s<30){const f=Math.floor(s/7);return f===1?"1 week ago":`${f} weeks ago`}if(s<365){const f=Math.floor(s/30);return f===1?"1 month ago":`${f} months ago`}return e.toLocaleDateString()},V=async o=>{if(!o.email){m.notify({type:"warning",message:`No email address available for ${o.name}`,position:"top",timeout:3e3});return}try{await navigator.clipboard.writeText(o.email),m.notify({type:"positive",message:`Email copied: ${o.email}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(e){console.error("Failed to copy email:",e),m.notify({type:"negative",message:"Failed to copy email address",position:"top",timeout:3e3})}},N=o=>{h.push({name:"person-detail",params:{id:o.id}})},T=o=>{o.phone?(window.open(`sms:${o.phone}`),m.notify({type:"info",message:`Opening SMS to ${o.name}`,position:"top",timeout:2e3})):m.notify({type:"warning",message:`No phone number available for ${o.name}`,position:"top",timeout:3e3})},L=()=>{h.push({name:"person-edit",params:{id:"new"}})},z=o=>{h.push({name:"conversation-create",query:{participants:o.id}})},M=o=>{if(!o)return"grey-6";const e=new Date(o),r=new Date-e,s=Math.floor(r/(1e3*60*60*24));return s<=60?"positive":s<=180?"grey-7":"negative"},S=o=>{if(!o)return"text-grey-6";const e=new Date(o),r=new Date-e,s=Math.floor(r/(1e3*60*60*24));return s<=60?"text-positive":s<=180?"text-grey-8":"text-negative"};return B(()=>{b()}),(o,e)=>(n(),x(K,{view:"lHh Lpr lFf"},{default:l(()=>[a(X,{onToggleDrawer:e[0]||(e[0]=t=>w.value=!w.value)}),a(ee,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=t=>w.value=t)},null,8,["modelValue"]),a(te,null,{default:l(()=>[a(oe,{class:"q-pa-md",style:{"background-color":"#f8f9fa"}},{default:l(()=>[c("div",se,[e[4]||(e[4]=c("div",{class:"text-h4 col"},"People",-1)),a(p,{color:"primary",icon:"add",label:"Add Person",onClick:L})]),c("div",le,[c("div",ne,[a(R,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t),filled:"",placeholder:"Search people...",clearable:""},{prepend:l(()=>[a(y,{name:"search"})]),_:1},8,["modelValue"])]),c("div",re,[a(H,{modelValue:C.value,"onUpdate:modelValue":[e[3]||(e[3]=t=>C.value=t),b],filled:"",options:$,label:"Sort by","emit-value":"","map-options":""},null,8,["modelValue"])])]),I(g).isLoading?(n(),i("div",ie,[a(J,{size:"50px",color:"primary"}),e[5]||(e[5]=c("div",{class:"q-mt-md"},"Loading people...",-1))])):Q.value.length===0?(n(),i("div",ce,[a(y,{name:"people_outline",size:"80px",color:"grey-5"}),c("div",de,v(d.value?"No people found matching your search":"No people added yet"),1),d.value?_("",!0):(n(),x(p,{key:0,color:"primary",label:"Add Your First Person",class:"q-mt-md",onClick:L}))])):(n(),i("div",ue,[(n(!0),i(O,null,U(Q.value,t=>(n(),i("div",{key:t.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[a(Y,{class:"person-card full-height cursor-pointer flex column",onClick:r=>N(t)},{default:l(()=>[a(Z,{class:"flex-grow-1"},{default:l(()=>[c("div",me,v(t.name),1),t.name_ext?(n(),i("div",fe,v(t.name_ext),1)):_("",!0),t.location?(n(),i("div",pe,[a(y,{name:"place",size:"16px",class:"q-mr-xs"}),u(" "+v(t.location),1)])):_("",!0),t.last_contacted?(n(),i("div",{key:2,class:j(["text-caption",S(t.last_contacted)])},[a(y,{name:"schedule",size:"14px",class:"q-mr-xs",color:M(t.last_contacted)},null,8,["color"]),u(" Last contact: "+v(P(t.last_contacted)),1)],2)):(n(),i("div",ye,[a(y,{name:"schedule",size:"14px",class:"q-mr-xs"}),e[6]||(e[6]=u(" No contact recorded ",-1))]))]),_:2},1024),a(G,{align:"right"},{default:l(()=>[t.email?(n(),x(p,{key:0,flat:"",round:"",size:"md",icon:"email",color:"info",onClick:q(r=>V(t),["stop"])},{default:l(()=>[a(D,null,{default:l(()=>[...e[7]||(e[7]=[u("Copy Email Address",-1)])]),_:1})]),_:2},1032,["onClick"])):_("",!0),t.phone?(n(),x(p,{key:1,flat:"",round:"",size:"md",icon:"sms",color:"info",onClick:q(r=>T(t),["stop"])},{default:l(()=>[a(D,null,{default:l(()=>[...e[8]||(e[8]=[u("Send Text Message",-1)])]),_:1})]),_:2},1032,["onClick"])):_("",!0),a(p,{flat:"",round:"",size:"md",icon:"add",color:"primary",onClick:q(r=>z(t),["stop"])},{default:l(()=>[a(D,null,{default:l(()=>[...e[9]||(e[9]=[u("Log Conversation",-1)])]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]),_:1})]),_:1})]),_:1}))}},Qe=F(_e,[["__scopeId","data-v-188bf753"]]);export{Qe as default};
