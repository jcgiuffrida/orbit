import{Q as X}from"./QSpinnerDots-DKX6m9Q8.js";import{g as A,H as ue,d as P,c as E,_ as ae,I as pe,J as le,e as ne,r as me,f as H,o as r,w as n,b as e,n as V,h as o,a as u,j as q,i as w,F as ie,p as re,k as R,t as p,l as k,K as Z,m as Q,E as ve,q as ee,L as te,M as ye,D as fe,u as I,s as he}from"./main-BNYyCrAV.js";import{Q as ge,a as oe}from"./QBreadcrumbs-C5l2t67P.js";import{Q as Y}from"./QTooltip-DaHthXlo.js";import{u as de,d as _e,e as xe,f as be,_ as we,a as qe,Q as Ce,b as ke}from"./NavigationDrawer-CoZBpgI1.js";import{u as ce}from"./people-DXZZurFb.js";import{u as Re,g as Pe,a as De,b as $e}from"./conversations-DG4JxOq_.js";import{f as Fe}from"./dateFormatting-Bb5cIjpU.js";import{Q as se}from"./QSelect-D7AnBUJS.js";import"./position-engine--pu8bc_Q.js";import"./QItemLabel-Co7gJjbr.js";const j={async getAll(){return(await A.get("relationships/")).data},async getByPerson(d){const v=await A.get("relationships/");return(v.data.results||v.data).filter(b=>b.person1===d||b.person2===d)},async getById(d){return(await A.get(`relationships/${d}/`)).data},async create(d){return(await A.post("relationships/",d)).data},async update(d,v){return(await A.put(`relationships/${d}/`,v)).data},async partialUpdate(d,v){return(await A.patch(`relationships/${d}/`,v)).data},async delete(d){return await A.delete(`relationships/${d}/`),!0},getRelationshipTypes(){return[{label:"Partner",value:"partner"},{label:"Family",value:"family"},{label:"Friend",value:"friend"},{label:"Colleague",value:"colleague"},{label:"Acquaintance",value:"acquaintance"},{label:"Other",value:"other"}]}},Te=ue("relationships",()=>{const d=P([]),v=P(!1),y=P(!1),b=P(null),h=P(null),S=1800*1e3,z=E(()=>h.value?Date.now()-h.value<S:!1),$=E(()=>d.value),F=E(()=>d.value.length),_=g=>{v.value=g,g&&(y.value=!1,b.value=null)},t=g=>{y.value=!0,b.value=g,v.value=!1},C=()=>{y.value=!1,b.value=null};return{relationships:d,isLoading:v,hasError:y,error:b,getRelationshipsList:$,relationshipsCount:F,isCacheValid:z,fetchAllRelationships:async(g=!1)=>{if(!g&&z.value&&d.value.length>0)return d.value;_(!0),C();try{const m=await j.getAll();return d.value=m.results||m,h.value=Date.now(),d.value}catch(m){throw console.error("Failed to fetch relationships:",m),t("Failed to load relationships"),m}finally{_(!1)}},getRelationshipsForPerson:g=>d.value.filter(m=>m.person1===g||m.person2===g),createRelationship:async g=>{_(!0),C();try{const m=await j.create(g);return d.value.push(m),h.value=Date.now(),m}catch(m){throw console.error("Failed to create relationship:",m),t("Failed to create relationship"),m}finally{_(!1)}},updateRelationship:async(g,m)=>{_(!0),C();try{const T=await j.update(g,m),N=d.value.findIndex(O=>O.id===g);return N>=0&&(d.value[N]=T),T}catch(T){throw console.error("Failed to update relationship:",T),t("Failed to update relationship"),T}finally{_(!1)}},deleteRelationship:async g=>{_(!0),C();try{await j.delete(g),d.value=d.value.filter(m=>m.id!==g)}catch(m){throw console.error("Failed to delete relationship:",m),t("Failed to delete relationship"),m}finally{_(!1)}},invalidateCache:()=>{h.value=null}}}),Ve={class:"row items-center q-mb-md"},ze={key:0,class:"text-center q-pa-md"},Le={key:1,class:"text-center q-pa-lg"},Qe={key:2},Ae={class:"row items-center q-gutter-sm"},Ie={class:"col"},Ee={class:"text-body1"},Se={class:"text-caption text-grey-6"},Ne={key:0},Be={class:"row q-gutter-xs"},Ue={class:"text-h6"},Me={class:"q-gutter-md"},Oe={class:"q-ml-sm"},He={__name:"PersonRelationships",props:{personId:{type:String,required:!0},personName:{type:String,required:!0}},setup(d){const v=d,y=de(),b=ce(),h=Te(),S=E(()=>h.getRelationshipsForPerson(v.personId)),z=E(()=>h.isLoading),$=P(!1),F=P(!1),_=P(!1),t=P(null),C=P(null),L=P([]),x=pe({selectedPerson:null,relationshipType:"",description:""}),B=E(()=>j.getRelationshipTypes()),U=async(l=!1)=>{try{await h.fetchAllRelationships(l)}catch(a){console.error("Error loading relationships:",a),y.notify({type:"negative",message:"Failed to load relationships",position:"top",timeout:3e3})}},M=async()=>{try{const l=b.peopleCount<=1;await b.fetchPeople(l);const a=b.getPeopleList;L.value=a.filter(D=>D.id!==v.personId)}catch(l){console.error("Error loading people:",l),y.notify({type:"negative",message:"Failed to load people list",position:"top",timeout:3e3})}},J=(l,a)=>{a(()=>{const D=b.getPeopleList;if(l==="")L.value=D.filter(c=>c.id!==v.personId);else{const c=l.toLowerCase();L.value=D.filter(K=>K.id!==v.personId&&K.name.toLowerCase().includes(c))}})},g=l=>l.person1===v.personId?l.person2_name:l.person1_name,m=l=>{const a=B.value.find(D=>D.value===l);return a?a.label:l},T=l=>({partner:"favorite",family:"family_restroom",friend:"people",colleague:"work",acquaintance:"person",other:"help"})[l]||"person",N=l=>{t.value=l,x.selectedPerson=l.person1===v.personId?l.person2:l.person1,x.relationshipType=l.relationship_type,x.description=l.description||"",F.value=!0},O=l=>{C.value=l,_.value=!0},G=async()=>{if(!x.selectedPerson||!x.relationshipType){y.notify({type:"warning",message:"Please fill in all required fields",position:"top",timeout:3e3});return}$.value=!0;try{const l={person1:v.personId,person2:x.selectedPerson,relationship_type:x.relationshipType,description:x.description||""};t.value?(await h.updateRelationship(t.value.id,l),y.notify({type:"positive",message:"Relationship updated successfully",position:"top",timeout:3e3})):(await h.createRelationship(l),y.notify({type:"positive",message:"Relationship added successfully",position:"top",timeout:3e3})),f()}catch(l){console.error("Error saving relationship:",l),y.notify({type:"negative",message:`Failed to ${t.value?"update":"add"} relationship`,position:"top",timeout:3e3})}finally{$.value=!1}},W=async()=>{if(C.value)try{await h.deleteRelationship(C.value.id),y.notify({type:"positive",message:"Relationship deleted successfully",position:"top",timeout:3e3}),_.value=!1,C.value=null}catch(l){console.error("Error deleting relationship:",l),y.notify({type:"negative",message:"Failed to delete relationship",position:"top",timeout:3e3})}},i=async()=>{await s(),F.value=!0},s=async()=>{L.value.length<1&&await M()},f=()=>{F.value=!1,t.value=null,x.selectedPerson=null,x.relationshipType="",x.description=""};return le(()=>v.personId,(l,a)=>{l&&l!==a&&!h.isCacheValid&&U()},{immediate:!1}),ne(()=>{(!h.isCacheValid||h.relationshipsCount===0)&&U(),M()}),(l,a)=>{const D=me("router-link");return r(),H(Q,{class:"content-card",flat:"",bordered:""},{default:n(()=>[e(V,{class:"q-pa-lg"},{default:n(()=>[o("div",Ve,[a[6]||(a[6]=o("div",{class:"text-h6 text-weight-medium col"},"Relationships",-1)),e(q,{outline:"",color:"primary",icon:"add",label:"Add Relationship",size:"sm",onClick:i})]),z.value?(r(),u("div",ze,[e(X,{size:"30px",color:"primary"}),a[7]||(a[7]=o("div",{class:"q-mt-sm text-grey-6"},"Loading relationships...",-1))])):S.value.length===0?(r(),u("div",Le,[e(w,{name:"people_outline",size:"48px",color:"grey-5"}),a[8]||(a[8]=o("div",{class:"text-body2 text-grey-6 q-mt-sm"},"No relationships recorded",-1))])):(r(),u("div",Qe,[(r(!0),u(ie,null,re(S.value,c=>(r(),u("div",{key:c.id,class:"relationship-item q-mb-md"},[o("div",Ae,[e(w,{name:T(c.relationship_type),size:"20px",color:"grey-7"},null,8,["name"]),o("div",Ie,[o("div",Ee,[e(D,{to:{name:"person-detail",params:{id:g(c)===c.person1_name?c.person1:c.person2}}},{default:n(()=>[R(p(g(c)),1)]),_:2},1032,["to"])]),o("div",Se,[R(p(m(c.relationship_type))+" ",1),c.description?(r(),u("span",Ne," â€¢ "+p(c.description),1)):k("",!0)])]),o("div",Be,[e(q,{flat:"",dense:"",round:"",size:"sm",icon:"edit",color:"grey-6",onClick:K=>N(c)},{default:n(()=>[e(Y,null,{default:n(()=>[...a[9]||(a[9]=[R("Edit",-1)])]),_:1})]),_:2},1032,["onClick"]),e(q,{flat:"",dense:"",round:"",size:"sm",icon:"delete",color:"grey-6",onClick:K=>O(c)},{default:n(()=>[e(Y,null,{default:n(()=>[...a[10]||(a[10]=[R("Delete",-1)])]),_:1})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1}),e(Z,{modelValue:F.value,"onUpdate:modelValue":a[3]||(a[3]=c=>F.value=c)},{default:n(()=>[e(Q,{style:{"min-width":"400px"}},{default:n(()=>[e(V,null,{default:n(()=>[o("div",Ue,p(t.value?"Edit Relationship":"Add Relationship"),1)]),_:1}),e(V,{class:"q-pt-none"},{default:n(()=>[o("div",Me,[e(se,{modelValue:x.selectedPerson,"onUpdate:modelValue":a[0]||(a[0]=c=>x.selectedPerson=c),options:L.value,"option-label":"name","option-value":"id",label:"Person *",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",clearable:"",autofocus:"","emit-value":"","map-options":"",onFilter:J,onPopupShow:s,rules:[c=>!!c||"Person is required"]},{"no-option":n(()=>[e(_e,null,{default:n(()=>[e(xe,{class:"text-grey"},{default:n(()=>[R(p(L.value.length===0?"Loading people...":"No people found"),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"]),e(se,{modelValue:x.relationshipType,"onUpdate:modelValue":a[1]||(a[1]=c=>x.relationshipType=c),options:B.value,label:"Relationship Type *",filled:"","emit-value":"","map-options":"",rules:[c=>!!c||"Relationship type is required"]},null,8,["modelValue","options","rules"]),e(ve,{modelValue:x.description,"onUpdate:modelValue":a[2]||(a[2]=c=>x.description=c),label:"Description",hint:"e.g., 'college roommate', 'sister-in-law'",filled:"",autocomplete:"off"},null,8,["modelValue"])])]),_:1}),e(ee,{align:"right"},{default:n(()=>[e(q,{flat:"",label:"Cancel",color:"grey-7",onClick:f}),e(q,{flat:"",label:t.value?"Save Changes":"Add Relationship",color:"primary",loading:$.value,onClick:G},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:_.value,"onUpdate:modelValue":a[5]||(a[5]=c=>_.value=c)},{default:n(()=>[e(Q,null,{default:n(()=>[e(V,{class:"row items-center"},{default:n(()=>[e(te,{icon:"warning",color:"negative","text-color":"white"}),o("span",Oe,[a[11]||(a[11]=R(" Are you sure you want to delete the relationship with ",-1)),o("strong",null,p(C.value?.person1_name===d.personName?C.value?.person2_name:C.value?.person1_name),1),a[12]||(a[12]=R("? ",-1))])]),_:1}),e(ee,{align:"between"},{default:n(()=>[e(q,{flat:"",label:"Cancel",color:"grey-7",onClick:a[4]||(a[4]=c=>_.value=!1)}),e(q,{flat:"",label:"Delete",color:"negative",onClick:W})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},je=ae(He,[["__scopeId","data-v-2e32aae6"]]),Je={key:0,class:"text-center q-pa-xl"},Ke={key:1,class:"text-center q-pa-xl"},Ye={class:"text-h6 text-negative q-mt-md"},Ge={key:2,class:"text-center q-pa-xl"},We={key:3,class:"person-detail-container"},Xe={class:"breadcrumb-nav q-mb-md"},Ze={class:"row items-start q-gutter-md"},et={class:"col"},tt={class:"text-h4 q-mb-sm text-weight-medium"},ot={key:0,class:"text-h6 text-grey-7 q-mb-md"},st={class:"text-body2 text-grey-6"},at={key:0},lt={class:"col-auto"},nt={class:"action-buttons"},it={class:"row q-col-gutter-lg"},rt={class:"col-12 col-md-6"},dt={key:0,class:"contact-item q-mb-md"},ct={class:"row items-center q-gutter-sm"},ut={class:"col text-body1"},pt={key:1,class:"contact-item q-mb-md"},mt={class:"row items-start q-gutter-sm"},vt={class:"col text-body1",style:{"white-space":"pre-line"}},yt={key:2,class:"contact-item q-mb-md"},ft={class:"row items-center q-gutter-sm"},ht={class:"col text-body1"},gt={key:3,class:"contact-item q-mb-md"},_t={class:"row items-center q-gutter-sm"},xt={class:"col text-body1"},bt={key:4,class:"contact-item q-mb-md"},wt={class:"row items-center q-gutter-sm"},qt={class:"col text-body1"},Ct={key:5,class:"contact-item q-mb-md"},kt={class:"row items-center q-gutter-sm"},Rt={class:"col"},Pt={class:"text-body1"},Dt={key:0,class:"text-grey-6"},$t={key:6,class:"contact-item q-mb-md"},Ft={class:"row items-center q-gutter-sm"},Tt={class:"col"},Vt={key:7,class:"contact-item"},zt={class:"row items-start q-gutter-sm"},Lt={class:"col q-ml-sm"},Qt={class:"text-body2 text-grey-7"},At={class:"text-body1 text-grey-8 pre-line"},It={class:"col-12 col-md-6"},Et={class:"text-body1 text-grey-8 pre-line ai-summary-text"},St={key:0,class:"text-center q-pa-md"},Nt={key:1,class:"text-center q-pa-md"},Bt={key:2,class:"conversations-scroll-container"},Ut=["onClick"],Mt={class:"row items-start q-gutter-sm"},Ot={class:"col"},Ht={class:"text-body2 text-weight-medium q-mb-xs"},jt={key:0},Jt={class:"text-caption text-grey-6 q-mb-xs"},Kt={class:"text-body2 text-grey-7 conversation-preview"},Yt={key:0,class:"q-mt-sm text-warning"},Gt={class:"q-ml-sm"},Wt={__name:"PersonDetailView",setup(d){const v=ye(),y=fe(),b=de(),h=ce(),S=Re(),z=P(!1),$=P(!1),F=P(!1),_=P([]),t=E(()=>h.selectedPerson),C=async()=>{const i=v.params.id;if(i)try{await h.fetchPersonById(i),await L()}catch(s){console.error("Failed to load person:",s)}},L=async()=>{if(t.value){F.value=!0,_.value=[];try{const i=await S.fetchConversationsForPerson(t.value.id);_.value=i||[]}catch(i){console.error("Failed to load conversations:",i),_.value=[]}finally{F.value=!1}}},x=()=>{y.push({name:"people"})},B=()=>{t.value&&y.push({name:"person-edit",params:{id:t.value.id}})},U=async()=>{if(t.value)try{const i=t.value.name;await h.deletePerson(t.value.id),$.value=!1,b.notify({type:"positive",message:`${i} deleted successfully`,position:"top",timeout:4e3,actions:[{icon:"close",color:"white",dense:!0}]}),y.push({name:"people"})}catch(i){console.error("Failed to delete person:",i),b.notify({type:"negative",message:"Failed to delete person. Please try again.",position:"top",timeout:4e3})}},M=async()=>{if(t.value?.email)try{await navigator.clipboard.writeText(t.value.email),b.notify({type:"positive",message:`Email copied: ${t.value.email}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(i){console.error("Failed to copy email:",i),b.notify({type:"negative",message:"Failed to copy email address",position:"top",timeout:3e3})}},J=async()=>{if(t.value?.phone)try{await navigator.clipboard.writeText(t.value.phone),b.notify({type:"positive",message:`Phone number copied: ${t.value.phone}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(i){console.error("Failed to copy phone number:",i),b.notify({type:"negative",message:"Failed to copy phone number",position:"top",timeout:3e3})}},g=()=>{t.value&&y.push({name:"conversation-create",query:{participants:t.value.id}})},m=()=>{t.value&&y.push({name:"ping-create",query:{person:t.value.id}})},T=i=>{if(!i)return"Never";const s=new Date(i),l=new Date-s,a=Math.floor(l/(1e3*60*60*24));if(a===0)return"Today";if(a===1)return"Yesterday";if(a<7)return a===1?"1 day ago":`${a} days ago`;if(a<30){const D=Math.floor(a/7);return D===1?"1 week ago":`${D} weeks ago`}if(a<365){const D=Math.floor(a/30);return D===1?"1 month ago":`${D} months ago`}return s.toLocaleDateString()},N=(i,s)=>!i||i.length<=s?i:i.substring(0,s).trim()+"...",O=i=>{y.push({name:"conversation-detail",params:{id:i.id}})},G=i=>{if(!i)return"grey-6";const s=new Date(i),l=new Date-s,a=Math.floor(l/(1e3*60*60*24));return a<=60?"positive":a<=365?"grey-7":"negative"},W=i=>{if(!i)return"text-grey-6";const s=new Date(i),l=new Date-s,a=Math.floor(l/(1e3*60*60*24));return a<=60?"text-positive":a<=365?"text-grey-8":"text-negative"};return le(()=>v.params.id,(i,s)=>{i&&i!==s&&(_.value=[],C())}),ne(()=>{C()}),(i,s)=>(r(),H(be,{view:"lHh Lpr lFf"},{default:n(()=>[e(we,{onToggleDrawer:s[0]||(s[0]=f=>z.value=!z.value)}),e(qe,{modelValue:z.value,"onUpdate:modelValue":s[1]||(s[1]=f=>z.value=f)},null,8,["modelValue"]),e(Ce,null,{default:n(()=>[e(ke,{class:"q-pa-md",style:{"background-color":"#f8f9fa"}},{default:n(()=>[I(h).isLoading?(r(),u("div",Je,[e(X,{size:"50px",color:"primary"}),s[5]||(s[5]=o("div",{class:"q-mt-md"},"Loading person details...",-1))])):I(h).hasError?(r(),u("div",Ke,[e(w,{name:"error_outline",size:"80px",color:"negative"}),o("div",Ye,p(I(h).error),1),e(q,{color:"primary",label:"Try Again",class:"q-mt-md",onClick:C})])):t.value?(r(),u("div",We,[o("div",Xe,[e(ge,{class:"text-grey-6"},{default:n(()=>[e(oe,{icon:"people",label:"People",onClick:x,class:"cursor-pointer"}),e(oe,{label:t.value.name},null,8,["label"])]),_:1})]),e(Q,{class:"header-card q-mb-lg",flat:""},{default:n(()=>[e(V,{class:"q-pa-lg"},{default:n(()=>[o("div",Ze,[o("div",et,[o("div",tt,p(t.value.name),1),t.value.name_ext?(r(),u("div",ot,p(t.value.name_ext),1)):k("",!0),o("div",st,[e(w,{name:"schedule",size:"16px",class:"q-mr-xs"}),R(" Added "+p(T(t.value.created_at))+" ",1),t.value.created_by_username?(r(),u("span",at," by "+p(t.value.created_by_username),1)):k("",!0)])]),o("div",lt,[o("div",nt,[e(q,{color:"secondary",icon:"chat_bubble",label:"Log Conversation",class:"q-mr-sm",onClick:g}),e(q,{outline:"",color:"secondary",icon:"contact_phone",label:"Ping",class:"q-mr-sm",onClick:m}),e(q,{outline:"",color:"primary",icon:"edit",label:"Edit",class:"q-mr-sm",onClick:B}),e(q,{outline:"",color:"negative",icon:"delete",label:"Delete",onClick:s[2]||(s[2]=f=>$.value=!0)})])])])]),_:1})]),_:1}),o("div",it,[o("div",rt,[e(Q,{class:"content-card q-mb-lg",flat:"",bordered:""},{default:n(()=>[e(V,{class:"q-pa-lg"},{default:n(()=>[s[11]||(s[11]=o("div",{class:"text-h6 q-mb-md text-weight-medium"},"Contact Information",-1)),t.value.location?(r(),u("div",dt,[o("div",ct,[e(w,{name:"place",size:"20px",color:"grey-7"}),o("div",ut,p(t.value.location),1)])])):k("",!0),t.value.address?(r(),u("div",pt,[o("div",mt,[e(w,{name:"home",size:"20px",color:"grey-7",style:{"margin-top":"2px"}}),o("div",vt,p(t.value.address),1)])])):k("",!0),t.value.company?(r(),u("div",yt,[o("div",ft,[e(w,{name:"business",size:"20px",color:"grey-7"}),o("div",ht,p(t.value.company),1)])])):k("",!0),t.value.email?(r(),u("div",gt,[o("div",_t,[e(w,{name:"email",size:"20px",color:"grey-7"}),o("div",xt,p(t.value.email),1),e(q,{unelevated:"",size:"sm",icon:"content_copy",color:"info","text-color":"white",onClick:M,class:"contact-action-btn"},{default:n(()=>[e(Y,null,{default:n(()=>[...s[7]||(s[7]=[R("Copy Email",-1)])]),_:1})]),_:1})])])):k("",!0),t.value.phone?(r(),u("div",bt,[o("div",wt,[e(w,{name:"phone",size:"20px",color:"grey-7"}),o("div",qt,p(t.value.phone),1),e(q,{unelevated:"",size:"sm",icon:"content_copy",color:"info","text-color":"white",onClick:J,class:"contact-action-btn"},{default:n(()=>[e(Y,null,{default:n(()=>[...s[8]||(s[8]=[R("Copy Phone",-1)])]),_:1})]),_:1})])])):k("",!0),t.value.birthday_display?(r(),u("div",Ct,[o("div",kt,[e(w,{name:"cake",size:"20px",color:"grey-7"}),o("div",Rt,[o("div",Pt,[R(p(t.value.birthday_display)+" ",1),t.value.age?(r(),u("span",Dt,"(Age "+p(t.value.age)+")",1)):k("",!0)]),s[9]||(s[9]=o("div",{class:"text-caption text-grey-6"},"Birthday",-1))])])])):k("",!0),t.value.last_contacted?(r(),u("div",$t,[o("div",Ft,[e(w,{name:"schedule",size:"20px",color:G(t.value.last_contacted)},null,8,["color"]),o("div",Tt,[o("div",{class:he(["text-body1",W(t.value.last_contacted)])},p(T(t.value.last_contacted)),3),s[10]||(s[10]=o("div",{class:"text-caption text-grey-6"},"Last Contact",-1))])])])):k("",!0),t.value.how_we_met?(r(),u("div",Vt,[o("div",zt,[e(w,{name:"handshake",size:"18px",color:"grey-6"}),o("div",Lt,[o("div",Qt,p(t.value.how_we_met),1)])])])):k("",!0)]),_:1})]),_:1}),t.value.notes?(r(),H(Q,{key:0,class:"content-card q-mb-lg",flat:"",bordered:""},{default:n(()=>[e(V,{class:"q-pa-lg"},{default:n(()=>[s[12]||(s[12]=o("div",{class:"text-h6 q-mb-md text-weight-medium"},"Notes",-1)),o("div",At,p(t.value.notes),1)]),_:1})]),_:1})):k("",!0),(r(),H(je,{key:t.value.id,"person-id":t.value.id,"person-name":t.value.name},null,8,["person-id","person-name"]))]),o("div",It,[t.value.ai_summary?(r(),H(Q,{key:0,class:"content-card q-mb-lg",flat:"",bordered:""},{default:n(()=>[e(V,{class:"q-pa-lg"},{default:n(()=>[s[13]||(s[13]=o("div",{class:"text-h6 q-mb-md text-weight-medium"},"Conversation History",-1)),o("div",Et,p(t.value.ai_summary),1)]),_:1})]),_:1})):k("",!0),e(Q,{class:"content-card q-mb-lg",flat:"",bordered:""},{default:n(()=>[e(V,{class:"q-pa-lg"},{default:n(()=>[s[17]||(s[17]=o("div",{class:"text-h6 q-mb-md text-weight-medium"},"Conversations",-1)),F.value?(r(),u("div",St,[e(X,{size:"20px",color:"primary"}),s[14]||(s[14]=o("div",{class:"text-caption text-grey-6 q-mt-sm"},"Loading conversations...",-1))])):_.value.length===0?(r(),u("div",Nt,[e(w,{name:"chat_bubble_outline",size:"32px",color:"grey-4"}),s[15]||(s[15]=o("div",{class:"text-body2 text-grey-6 q-mt-sm"},"No conversations recorded yet",-1))])):(r(),u("div",Bt,[(r(!0),u(ie,null,re(_.value,f=>(r(),u("div",{key:f.id,class:"conversation-timeline-item q-mb-sm cursor-pointer",onClick:l=>O(f)},[o("div",Mt,[e(te,{size:"32px",color:I(Pe)(f.type),"text-color":"white"},{default:n(()=>[e(w,{name:I(De)(f.type),size:"16px"},null,8,["name"])]),_:2},1032,["color"]),o("div",Ot,[o("div",Ht,[R(p(I($e)(f.type))+" ",1),f.location?(r(),u("span",jt," â€¢ "+p(f.location),1)):k("",!0)]),o("div",Jt,p(I(Fe)(f.date)),1),o("div",Kt,p(N(f.notes,150)),1),f.private?(r(),u("div",Yt,[e(w,{name:"lock",class:"q-mb-xs"}),s[16]||(s[16]=R(" Private to you ",-1))])):k("",!0)]),e(w,{name:"chevron_right",color:"grey-4",size:"16px"})])],8,Ut))),128))]))]),_:1})]),_:1})])])])):(r(),u("div",Ge,[e(w,{name:"person_off",size:"80px",color:"grey-5"}),s[6]||(s[6]=o("div",{class:"text-h6 text-grey-7 q-mt-md"}," Person not found ",-1)),e(q,{color:"primary",label:"Back to People",class:"q-mt-md",onClick:x})])),e(Z,{modelValue:$.value,"onUpdate:modelValue":s[4]||(s[4]=f=>$.value=f)},{default:n(()=>[e(Q,null,{default:n(()=>[e(V,{class:"row items-center"},{default:n(()=>[e(te,{icon:"warning",color:"negative","text-color":"white"}),o("span",Gt,[s[18]||(s[18]=R(" Are you sure you want to delete ",-1)),o("strong",null,p(t.value?.name),1),s[19]||(s[19]=R("? This action cannot be undone. ",-1))])]),_:1}),e(ee,{align:"between"},{default:n(()=>[e(q,{flat:"",label:"Cancel",color:"grey-7",onClick:s[3]||(s[3]=f=>$.value=!1)}),e(q,{flat:"",label:"Delete",color:"negative",onClick:U})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},co=ae(Wt,[["__scopeId","data-v-722ba4e5"]]);export{co as default};
