import{Q as I,a as B}from"./QSpinnerDots-rM26rU5M.js";import{_ as S,d as T,c as E,J as U,e as j,f as $,w as n,M,u as R,o as i,b as e,a as c,m as u,h as a,i as m,t as r,j as v,n as x,p as h,L as w,l as b,k as p,F as H,q as J,K,s as O}from"./main-C8eLUZHf.js";import{Q as G,a as L}from"./QBreadcrumbs-d9osul-O.js";import{f as W,u as X,_ as Y,a as Z,Q as ee,b as te}from"./NavigationDrawer-CgCiqeaQ.js";import{u as oe,g as ae,a as se,b as ne}from"./conversations-Coh1HZj_.js";import{f as z,a as le}from"./dateFormatting-Bb5cIjpU.js";const ie={key:0,class:"text-center q-pa-xl"},re={key:1,class:"text-center q-pa-xl"},ce={class:"text-h6 text-negative q-mt-md"},de={key:2,class:"text-center q-pa-xl"},ue={key:3,class:"conversation-detail-container"},me={class:"breadcrumb-nav q-mb-md"},ve={class:"row items-start q-gutter-md"},pe={class:"col-auto"},_e={class:"col"},fe={class:"row items-center q-gutter-sm q-mb-sm"},ge={class:"text-h5 text-weight-medium"},ye={class:"text-body1 text-grey-8 q-mb-sm"},xe={key:0},he={class:"text-body2 text-grey-6"},be={key:0},Ce={class:"col-auto"},we={class:"action-buttons"},ke={class:"row q-col-gutter-lg"},qe={class:"col-12 col-md-4"},Qe=["onClick"],De={class:"col"},Ve={class:"text-body2 text-weight-medium"},Be={key:0,class:"text-caption text-grey-6"},Te={class:"col-12 col-md-8"},$e={class:"text-body1 text-grey-8 pre-line conversation-notes"},Le={class:"q-ml-sm"},ze={__name:"ConversationDetailView",setup(Ne){const k=M(),f=R(),q=X(),d=oe(),g=T(!1),_=T(!1),o=E(()=>d.selectedConversation),y=s=>!s||s.length===0?"Unknown":s.map(t=>t.name).join(", "),Q=s=>se(s),N=s=>ne(s),D=s=>ae(s),C=async()=>{const s=k.params.id;if(s)try{await d.fetchConversationById(s)}catch(t){console.error("Failed to load conversation:",t)}},V=()=>{f.push({name:"conversations"})},P=()=>{o.value&&f.push({name:"conversation-edit",params:{id:o.value.id}})},F=s=>{f.push({name:"person-detail",params:{id:s.id}})},A=async()=>{if(o.value)try{const s=y(o.value.participants);await d.deleteConversation(o.value.id),_.value=!1,q.notify({type:"positive",message:`Conversation with ${s} deleted successfully`,position:"top",timeout:4e3,actions:[{icon:"close",color:"white",dense:!0}]}),f.push({name:"conversations"})}catch(s){console.error("Failed to delete conversation:",s),q.notify({type:"negative",message:"Failed to delete conversation. Please try again.",position:"top",timeout:4e3})}};return U(()=>k.params.id,(s,t)=>{s&&s!==t&&C()}),j(()=>{C()}),(s,t)=>(i(),$(W,{view:"lHh Lpr lFf"},{default:n(()=>[e(Y,{onToggleDrawer:t[0]||(t[0]=l=>g.value=!g.value)}),e(Z,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=l=>g.value=l)},null,8,["modelValue"]),e(ee,null,{default:n(()=>[e(te,{class:"q-pa-md",style:{"background-color":"#f8f9fa"}},{default:n(()=>[u(d).isLoading?(i(),c("div",ie,[e(I,{size:"50px",color:"primary"}),t[5]||(t[5]=a("div",{class:"q-mt-md"},"Loading conversation details...",-1))])):u(d).hasError?(i(),c("div",re,[e(m,{name:"error_outline",size:"80px",color:"negative"}),a("div",ce,r(u(d).error),1),e(v,{color:"primary",label:"Try Again",class:"q-mt-md",onClick:C})])):o.value?(i(),c("div",ue,[a("div",me,[e(G,{class:"text-grey-6"},{default:n(()=>[e(L,{icon:"chat",label:"Conversations",onClick:V,class:"cursor-pointer"}),e(L,{label:`${y(o.value.participants)} - ${u(z)(o.value.date)}`},null,8,["label"])]),_:1})]),e(x,{class:"header-card q-mb-lg",flat:""},{default:n(()=>[e(h,{class:"q-pa-lg"},{default:n(()=>[a("div",ve,[a("div",pe,[e(w,{size:"64px",color:D(o.value.type),"text-color":"white"},{default:n(()=>[e(m,{name:Q(o.value.type),size:"32px"},null,8,["name"])]),_:1},8,["color"])]),a("div",_e,[a("div",fe,[a("div",ge,r(y(o.value.participants)),1),e(B,{color:D(o.value.type),"text-color":"white",icon:Q(o.value.type)},{default:n(()=>[p(r(N(o.value.type)),1)]),_:1},8,["color","icon"]),o.value.private?(i(),$(B,{key:0,color:"orange","text-color":"white",icon:"lock"},{default:n(()=>[...t[7]||(t[7]=[p(" Private to you ",-1)])]),_:1})):b("",!0)]),a("div",ye,[p(r(u(z)(o.value.date))+" ",1),o.value.location?(i(),c("span",xe," â€¢ "+r(o.value.location),1)):b("",!0)]),a("div",he,[e(m,{name:"schedule",size:"16px",class:"q-mr-xs"}),p(" Added "+r(u(le)(o.value.created_at))+" ",1),o.value.created_by_username?(i(),c("span",be," by "+r(o.value.created_by_username),1)):b("",!0)])]),a("div",Ce,[a("div",we,[e(v,{outline:"",color:"primary",icon:"edit",label:"Edit",class:"q-mr-sm",onClick:P}),e(v,{outline:"",color:"negative",icon:"delete",label:"Delete",onClick:t[2]||(t[2]=l=>_.value=!0)})])])])]),_:1})]),_:1}),a("div",ke,[a("div",qe,[e(x,{class:"content-card",flat:"",bordered:""},{default:n(()=>[e(h,{class:"q-pa-lg"},{default:n(()=>[t[8]||(t[8]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Participants",-1)),(i(!0),c(H,null,J(o.value.participants,l=>(i(),c("div",{key:l.id,class:"participant-item"},[a("div",{class:"row items-center q-gutter-sm cursor-pointer",onClick:Pe=>F(l)},[e(w,{size:"32px",color:"grey-4","text-color":"grey-8"},{default:n(()=>[e(m,{name:"person"})]),_:1}),a("div",De,[a("div",Ve,r(l.name),1),l.name_ext?(i(),c("div",Be,r(l.name_ext),1)):b("",!0)]),e(m,{name:"chevron_right",color:"grey-5"})],8,Qe)]))),128))]),_:1})]),_:1})]),a("div",Te,[e(x,{class:"content-card",flat:"",bordered:""},{default:n(()=>[e(h,{class:"q-pa-lg"},{default:n(()=>[t[9]||(t[9]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Notes",-1)),a("div",$e,r(o.value.notes),1)]),_:1})]),_:1})])])])):(i(),c("div",de,[e(m,{name:"chat_bubble_outline",size:"80px",color:"grey-5"}),t[6]||(t[6]=a("div",{class:"text-h6 text-grey-7 q-mt-md"}," Conversation not found ",-1)),e(v,{color:"primary",label:"Back to Conversations",class:"q-mt-md",onClick:V})])),e(K,{modelValue:_.value,"onUpdate:modelValue":t[4]||(t[4]=l=>_.value=l)},{default:n(()=>[e(x,null,{default:n(()=>[e(h,{class:"row items-center"},{default:n(()=>[e(w,{icon:"warning",color:"negative","text-color":"white"}),a("span",Le,[t[10]||(t[10]=p(" Are you sure you want to delete this conversation with ",-1)),a("strong",null,r(o.value?y(o.value.participants):""),1),t[11]||(t[11]=p("? This action cannot be undone. ",-1))])]),_:1}),e(O,{align:"between"},{default:n(()=>[e(v,{flat:"",label:"Cancel",color:"grey-7",onClick:t[3]||(t[3]=l=>_.value=!1)}),e(v,{flat:"",label:"Delete",color:"negative",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},je=S(ze,[["__scopeId","data-v-6cfaf4b9"]]);export{je as default};
