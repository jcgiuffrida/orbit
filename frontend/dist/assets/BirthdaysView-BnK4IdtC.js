import{_ as V,d as m,e as T,f as k,w as i,D as P,o,b as a,a as n,Q as N,h as t,i as y,t as d,j as p,k as v,m as b,n as w,F as O,p as $,s as g,l as h,G as z,O as F}from"./main-BNYyCrAV.js";import{Q as L}from"./QTooltip-DaHthXlo.js";import{f as S,_ as R,a as j,Q as A,b as M}from"./NavigationDrawer-CoZBpgI1.js";import"./position-engine--pu8bc_Q.js";const U={key:0,class:"flex flex-center q-mt-lg"},E={key:1,class:"text-center q-mt-lg"},H={class:"text-body2"},I={key:2},Y={key:0,class:"text-center q-mt-xl"},G={key:1,class:"row q-col-gutter-md"},W={class:"col-12"},J={class:"text-h6 q-mb-md"},K={class:"birthday-timeline"},X={class:"row items-center q-gutter-md"},Z={class:"col-auto birthday-date-col"},ee={key:0,class:"text-h6 text-weight-bold"},te={key:1,class:"text-subtitle1 text-weight-bold"},se={key:2,class:"text-subtitle1 text-weight-bold"},ae={key:3,class:"text-body2"},oe={class:"col"},le={class:"row items-center q-gutter-md"},ne={class:"col-auto"},ie={class:"col"},de={class:"text-h6"},re={class:"text-subtitle2 text-grey-6"},ce={key:0,class:"q-ml-sm"},ue={key:0,class:"text-caption text-grey-6"},me={class:"col-auto"},_e={__name:"BirthdaysView",setup(ye){const f=P(),c=m(!1),_=m(!0),u=m(null),r=m(null),x=async()=>{_.value=!0,u.value=null;try{const l=await fetch("/api/birthdays/",{credentials:"include",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error(`HTTP ${l.status}`);r.value=await l.json()}catch(l){console.error("Failed to load birthdays:",l),u.value="Unable to load birthdays. Please try again."}finally{_.value=!1}},q=l=>{f.push({name:"person-detail",params:{id:l}})},C=l=>{f.push({name:"ping-create",query:{person:l}})},Q=l=>l?new Date(l).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"";return T(()=>{x()}),(l,s)=>(o(),k(S,{view:"lHh Lpr lFf"},{default:i(()=>[a(R,{onToggleDrawer:s[0]||(s[0]=e=>c.value=!c.value)}),a(j,{modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=e=>c.value=e)},null,8,["modelValue"]),a(A,null,{default:i(()=>[a(M,{class:"q-pa-md",style:{"background-color":"#f8f9fa"}},{default:i(()=>[_.value?(o(),n("div",U,[a(N,{size:"2em"})])):u.value?(o(),n("div",E,[a(y,{name:"error",size:"2em",color:"negative"}),s[3]||(s[3]=t("div",{class:"text-h6 q-mt-md"},"Failed to load birthdays",-1)),t("div",H,d(u.value),1),a(p,{onClick:x,color:"primary",class:"q-mt-md"},{default:i(()=>[...s[2]||(s[2]=[v("Retry",-1)])]),_:1})])):(o(),n("div",I,[s[7]||(s[7]=t("div",{class:"row items-center q-mb-lg"},[t("div",{class:"col"},[t("h1",{class:"text-h4 q-ma-none"}," Birthday Calendar "),t("p",{class:"text-subtitle1 text-grey-6 q-ma-none q-mt-sm"}," Upcoming birthdays starting today ")])],-1)),!r.value||r.value.birthdays.length===0?(o(),n("div",Y,[a(y,{name:"cake",size:"80px",color:"grey-5"}),s[4]||(s[4]=t("div",{class:"text-h6 q-mt-md text-grey-7"},"No upcoming birthdays",-1)),s[5]||(s[5]=t("div",{class:"text-body2 text-grey-6"}," Add birthday information to people's profiles to see them here ",-1)),a(p,{color:"primary",to:{name:"people"},class:"q-mt-md",label:"View People"})])):(o(),n("div",G,[t("div",W,[a(b,null,{default:i(()=>[a(w,null,{default:i(()=>[t("div",J,"Next "+d(r.value.birthdays.length)+" Birthdays",1),t("div",K,[(o(!0),n(O,null,$(r.value.birthdays,(e,B)=>(o(),n("div",{key:e.id,class:g(["birthday-entry q-mb-md",{"birthday-today":e.is_today}])},[t("div",X,[t("div",Z,[t("div",{class:g(["birthday-date-badge q-pa-md text-center",{"bg-accent text-white":e.is_today,"bg-primary text-white":e.days_until<=7&&!e.is_today,"bg-grey-2":e.days_until>7}])},[e.is_today?(o(),n("div",ee,"TODAY")):e.days_until===1?(o(),n("div",te,"TOMORROW")):e.days_until<=7?(o(),n("div",se,d(e.days_until)+" DAYS ",1)):(o(),n("div",ae,d(Q(e.next_birthday)),1))],2)]),t("div",oe,[a(b,{flat:"",class:g(["cursor-pointer birthday-person-card",{"bg-accent-1":e.is_today}]),onClick:D=>q(e.id)},{default:i(()=>[a(w,{class:"q-pa-md"},{default:i(()=>[t("div",le,[t("div",ne,[a(y,{name:e.is_today?"celebration":"cake",size:"32px",color:e.is_today?"accent":"primary"},null,8,["name","color"])]),t("div",ie,[t("div",de,d(e.name),1),t("div",re,[v(d(e.birthday_display)+" ",1),e.age?(o(),n("span",ce,"(turning "+d(e.age)+")",1)):h("",!0)]),e.name_ext?(o(),n("div",ue,d(e.name_ext),1)):h("",!0)]),t("div",me,[a(p,{flat:"",dense:"",round:"",icon:"contact_phone",color:"grey-6",onClick:z(D=>C(e.id),["stop"])},{default:i(()=>[a(L,null,{default:i(()=>[...s[6]||(s[6]=[v("Log Birthday Ping",-1)])]),_:1})]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1032,["class","onClick"])])]),B<r.value.birthdays.length-1?(o(),k(F,{key:0,class:"q-mt-md",color:"grey-3"})):h("",!0)],2))),128))])]),_:1})]),_:1})])]))]))]),_:1})]),_:1})]),_:1}))}},fe=V(_e,[["__scopeId","data-v-3e4f1243"]]);export{fe as default};
