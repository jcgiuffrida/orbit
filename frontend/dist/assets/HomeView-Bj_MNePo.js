import{_ as L,c as O,r as T,a as r,o as s,b as a,d as Q,e as B,f as p,g as F,w as t,Q as I,h as o,i as R,t as i,j as g,k as v,u as x,l as f,m as b,n as c,F as A,p as $,q as N}from"./main-BSNfDbTQ.js";import{Q as P}from"./QTooltip-BTYvVAAz.js";import{Q as q}from"./QItemLabel-CDBU9do_.js";import{u as W,_ as H,a as M,Q as Y,b as j,c as S,d as V,e as z,f as E}from"./NavigationDrawer-Cd3a0AvU.js";const U={class:"monthly-chart"},G={key:0,class:"text-body2 text-grey-6 text-center q-pa-lg"},J={key:1},K={__name:"ActivityChart",props:{data:{type:Array,default:()=>[]}},setup(k){const d=k,y=O(()=>{if(!d.data||d.data.length===0)return{};const n=d.data.map(_=>_.month_name),h=d.data.map(_=>_.conversations),m=d.data.map(_=>_.contact_attempts);return{chart:{type:"line",backgroundColor:"transparent",spacingTop:20,spacingBottom:20,spacingLeft:20,spacingRight:20},title:{text:null},xAxis:{categories:n,lineColor:"#e0e0e0",tickColor:"#e0e0e0",labels:{style:{color:"#666",fontSize:"12px"}}},yAxis:{title:{text:"Count",style:{color:"#666"}},min:0,gridLineColor:"#f0f0f0",labels:{style:{color:"#666",fontSize:"12px"}}},tooltip:{shared:!0,backgroundColor:"#ffffff",borderColor:"#e0e0e0",borderRadius:8,shadow:!0,useHTML:!0,formatter:function(){let C=`<div style="text-align: center; margin-bottom: 5px; font-weight: bold;">${this.points&&this.points.length>0?this.points[0].category:this.x}</div>`;return this.points&&this.points.forEach(w=>{C+=`<div style="margin: 2px 0;"><span style="color:${w.color}; font-size: 14px;">‚óè</span> ${w.series.name}: <b>${w.y}</b></div>`}),C}},legend:{align:"center",verticalAlign:"bottom",borderWidth:0,itemStyle:{color:"#666",fontSize:"12px"}},plotOptions:{line:{lineWidth:3,states:{hover:{lineWidth:4}}}},series:[{name:"Conversations",data:h,color:"#1976d2",marker:{fillColor:"#1976d2"}},{name:"Pings",data:m,color:"#424242",marker:{fillColor:"#424242"}}],credits:{enabled:!1},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"},xAxis:{labels:{rotation:-45,style:{fontSize:"10px"}}}}}]}}});return(n,h)=>{const m=T("highcharts");return s(),r("div",U,[!k.data||k.data.length===0?(s(),r("div",G," No activity data available ")):(s(),r("div",J,[a(m,{options:y.value,style:{height:"400px",width:"100%"}},null,8,["options"])]))])}}},X=L(K,[["__scopeId","data-v-64cbd7e6"]]),Z={key:0,class:"flex flex-center q-mt-lg"},tt={key:1,class:"text-center q-mt-lg"},et={class:"text-body2"},at={key:2},ot={class:"row items-center q-mb-lg"},st={class:"col-auto"},lt={class:"q-gutter-sm"},nt={class:"row q-mb-lg"},it={class:"col-12"},rt={class:"row q-mb-lg"},dt={class:"col-12"},ct={class:"row q-col-gutter-md"},ut={class:"col"},vt={class:"text-h6"},_t={key:0,class:"text-body2"},mt={class:"col"},pt={class:"text-h6"},ft={key:0,class:"text-body2"},yt={class:"col"},ht={class:"text-h6"},gt={key:0,class:"text-body2"},xt={class:"row q-col-gutter-md q-mb-lg"},bt={class:"col-12 col-md-6"},wt={class:"col-12 col-md-6"},kt={class:"row"},Ct={class:"col-12"},Qt={class:"row q-col-gutter-md"},qt={class:"text-h6"},At={key:0,class:"text-caption text-grey-6"},St={__name:"HomeView",setup(k){const d=W(),y=Q(!1),n=Q({}),h=Q(!0),m=Q(null),_=async()=>{try{h.value=!0,m.value=null;const u=await F.get("/dashboard/");n.value=u.data}catch(u){m.value=u.response?.data?.detail||"Failed to load dashboard data",console.error("Dashboard load error:",u)}finally{h.value=!1}},C=u=>new Date(u).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),w=(u,e,l)=>u===1?e:l;return B(()=>{_()}),(u,e)=>(s(),p(E,{view:"lHh Lpr lFf"},{default:t(()=>[a(H,{onToggleDrawer:e[0]||(e[0]=l=>y.value=!y.value)}),a(M,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=l=>y.value=l)},null,8,["modelValue"]),a(Y,null,{default:t(()=>[a(j,{class:"q-pa-md"},{default:t(()=>[h.value?(s(),r("div",Z,[a(I,{size:"2em"})])):m.value?(s(),r("div",tt,[a(R,{name:"error",size:"2em",color:"negative"}),e[3]||(e[3]=o("div",{class:"text-h6 q-mt-md"},"Failed to load dashboard",-1)),o("div",et,i(m.value),1),a(g,{onClick:_,color:"primary",class:"q-mt-md"},{default:t(()=>[...e[2]||(e[2]=[v("Retry",-1)])]),_:1})])):(s(),r("div",at,[o("div",ot,[e[7]||(e[7]=o("div",{class:"col"},[o("h1",{class:"text-h4 q-ma-none"},"Dashboard")],-1)),o("div",st,[o("div",lt,[a(g,{color:"accent",icon:"add_comment",to:{name:"conversation-create"},label:x(d).screen.gt.xs?"New Conversation":void 0},{default:t(()=>[x(d).screen.gt.xs?f("",!0):(s(),p(P,{key:0},{default:t(()=>[...e[4]||(e[4]=[v("New Conversation",-1)])]),_:1}))]),_:1},8,["label"]),a(g,{color:"secondary",icon:"contact_phone",to:{name:"contact-attempt-create"},label:x(d).screen.gt.xs?"New Ping":void 0},{default:t(()=>[x(d).screen.gt.xs?f("",!0):(s(),p(P,{key:0},{default:t(()=>[...e[5]||(e[5]=[v("New Ping",-1)])]),_:1}))]),_:1},8,["label"]),a(g,{color:"primary",icon:"person_add",to:{name:"person-edit",params:{id:"new"}},label:x(d).screen.gt.xs?"Add Person":void 0},{default:t(()=>[x(d).screen.gt.xs?f("",!0):(s(),p(P,{key:0},{default:t(()=>[...e[6]||(e[6]=[v("Add Person",-1)])]),_:1}))]),_:1},8,["label"])])])]),o("div",nt,[o("div",it,[a(b,null,{default:t(()=>[a(c,null,{default:t(()=>[...e[8]||(e[8]=[o("div",{class:"text-h6"},"Activity Over Past Year",-1)])]),_:1}),a(c,null,{default:t(()=>[a(X,{data:n.value.monthly_activity},null,8,["data"])]),_:1})]),_:1})])]),o("div",rt,[o("div",dt,[a(b,null,{default:t(()=>[a(c,null,{default:t(()=>[...e[9]||(e[9]=[o("div",{class:"text-h6"},"Activity Overview",-1)])]),_:1}),a(c,null,{default:t(()=>[o("div",ct,[o("div",ut,[e[10]||(e[10]=o("div",{class:"text-caption"},"Past Week",-1)),o("div",vt,i(n.value.activity_overview.conversations.week)+" conversations",1),n.value.activity_overview.contact_attempts.week>0?(s(),r("div",_t,"+ "+i(n.value.activity_overview.contact_attempts.week)+" pings",1)):f("",!0)]),o("div",mt,[e[11]||(e[11]=o("div",{class:"text-caption"},"Past Month",-1)),o("div",pt,i(n.value.activity_overview.conversations.month)+" conversations",1),n.value.activity_overview.contact_attempts.month>0?(s(),r("div",ft,"+ "+i(n.value.activity_overview.contact_attempts.month)+" pings",1)):f("",!0)]),o("div",yt,[e[12]||(e[12]=o("div",{class:"text-caption"},"Past Year",-1)),o("div",ht,i(n.value.activity_overview.conversations.year)+" conversations",1),n.value.activity_overview.contact_attempts.year>0?(s(),r("div",gt,"+ "+i(n.value.activity_overview.contact_attempts.year)+" pings",1)):f("",!0)])])]),_:1})]),_:1})])]),o("div",xt,[o("div",bt,[a(b,null,{default:t(()=>[a(c,null,{default:t(()=>[...e[13]||(e[13]=[o("div",{class:"text-h6"},"Recent Conversations",-1)])]),_:1}),a(c,null,{default:t(()=>[a(S,{separator:""},{default:t(()=>[(s(!0),r(A,null,$(n.value.recent_conversations.slice(0,8),l=>(s(),p(V,{key:l.id,to:{name:"conversation-detail",params:{id:l.id}},clickable:""},{default:t(()=>[a(z,null,{default:t(()=>[a(q,null,{default:t(()=>[v(i(C(l.date)),1)]),_:2},1024),a(q,{caption:""},{default:t(()=>[v(i(l.participants.map(D=>D.name).join(", ")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1}),a(N,{align:"center"},{default:t(()=>[a(g,{flat:"",to:{name:"conversations"}},{default:t(()=>[...e[14]||(e[14]=[v("View all",-1)])]),_:1})]),_:1})]),_:1})]),o("div",wt,[a(b,null,{default:t(()=>[a(c,null,{default:t(()=>[...e[15]||(e[15]=[o("div",{class:"text-h6"},"Top Contacts",-1),o("div",{class:"text-subtitle2"},"Past two years",-1)])]),_:1}),a(c,null,{default:t(()=>[a(S,{separator:""},{default:t(()=>[(s(!0),r(A,null,$(n.value.top_contacts.slice(0,8),l=>(s(),p(V,{key:l.id,to:{name:"person-detail",params:{id:l.id}},clickable:""},{default:t(()=>[a(z,null,{default:t(()=>[a(q,null,{default:t(()=>[v(i(l.name),1)]),_:2},1024),a(q,{caption:""},{default:t(()=>[v(i(l.conversation_count_recent)+" "+i(w(l.conversation_count_recent,"conversation","conversations")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1}),a(N,{align:"center"},{default:t(()=>[a(g,{flat:"",to:{name:"people"}},{default:t(()=>[...e[16]||(e[16]=[v("View all",-1)])]),_:1})]),_:1})]),_:1})])]),o("div",kt,[o("div",Ct,[a(b,null,{default:t(()=>[a(c,null,{default:t(()=>[...e[17]||(e[17]=[o("div",{class:"text-h6"},"People to Reach Out",-1)])]),_:1}),n.value.people_to_reach_out.length===0?(s(),p(c,{key:0},{default:t(()=>[...e[18]||(e[18]=[o("div",{class:"text-body2 text-grey-6"},"Great! You're up to date with everyone.",-1)])]),_:1})):(s(),p(c,{key:1},{default:t(()=>[o("div",Qt,[(s(!0),r(A,null,$(n.value.people_to_reach_out,l=>(s(),r("div",{key:l.id,class:"col-12 col-sm-6 col-md-4"},[a(b,{class:"cursor-pointer",onClick:D=>u.$router.push({name:"person-detail",params:{id:l.id}})},{default:t(()=>[a(c,null,{default:t(()=>[o("div",qt,i(l.name),1),l.days_since_last_contact?(s(),r("div",At,i(l.days_since_last_contact)+" days ago ",1)):f("",!0)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])]),_:1}))]),_:1})])])]))]),_:1})]),_:1})]),_:1}))}};export{St as default};
