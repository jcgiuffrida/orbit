import{Q as Z}from"./QSpinnerDots-D9CBjq5l.js";import{g as z,J as pe,d as q,c as Q,_ as le,I as me,K as ne,e as ie,r as ve,f as O,o as c,w as l,b as o,m as F,h as a,a as m,j as x,i as C,F as re,p as ce,k,t as v,n as R,L as ee,l as L,C as ye,q as te,M as oe,H as fe,B as he,D as M,E as ge}from"./main-DJ_tSYHB.js";import{Q as _e,a as se}from"./QBreadcrumbs-gqxnY20s.js";import{Q as K}from"./QTooltip-CJP9VBL5.js";import{u as de,d as we,e as xe,f as be,_ as qe,a as Ce,Q as ke,b as Re}from"./NavigationDrawer-CSW2CacQ.js";import{u as ue}from"./people-8Dc0MwE0.js";import{u as De,g as Pe,a as $e}from"./conversations-ihW6uWpz.js";import{Q as ae}from"./QSelect-D0WnEWAb.js";import"./QChip-B5LXG1Yj.js";import"./QItemLabel-BRFh0h6K.js";const H={async getAll(){return(await z.get("relationships/")).data},async getByPerson(i){const p=await z.get("relationships/");return(p.data.results||p.data).filter(w=>w.person1===i||w.person2===i)},async getById(i){return(await z.get(`relationships/${i}/`)).data},async create(i){return(await z.post("relationships/",i)).data},async update(i,p){return(await z.put(`relationships/${i}/`,p)).data},async partialUpdate(i,p){return(await z.patch(`relationships/${i}/`,p)).data},async delete(i){return await z.delete(`relationships/${i}/`),!0},getRelationshipTypes(){return[{label:"Partner",value:"partner"},{label:"Family",value:"family"},{label:"Friend",value:"friend"},{label:"Colleague",value:"colleague"},{label:"Acquaintance",value:"acquaintance"},{label:"Other",value:"other"}]}},Fe=pe("relationships",()=>{const i=q([]),p=q(!1),y=q(!1),w=q(null),f=q(null),A=1800*1e3,T=Q(()=>f.value?Date.now()-f.value<A:!1),D=Q(()=>i.value),P=Q(()=>i.value.length),g=h=>{p.value=h,h&&(y.value=!1,w.value=null)},s=h=>{y.value=!0,w.value=h,p.value=!1},b=()=>{y.value=!1,w.value=null};return{relationships:i,isLoading:p,hasError:y,error:w,getRelationshipsList:D,relationshipsCount:P,isCacheValid:T,fetchAllRelationships:async(h=!1)=>{if(!h&&T.value&&i.value.length>0)return i.value;g(!0),b();try{const d=await H.getAll();return i.value=d.results||d,f.value=Date.now(),i.value}catch(d){throw console.error("Failed to fetch relationships:",d),s("Failed to load relationships"),d}finally{g(!1)}},getRelationshipsForPerson:h=>i.value.filter(d=>d.person1===h||d.person2===h),createRelationship:async h=>{g(!0),b();try{const d=await H.create(h);return i.value.push(d),f.value=Date.now(),d}catch(d){throw console.error("Failed to create relationship:",d),s("Failed to create relationship"),d}finally{g(!1)}},updateRelationship:async(h,d)=>{g(!0),b();try{const $=await H.update(h,d),I=i.value.findIndex(N=>N.id===h);return I>=0&&(i.value[I]=$),$}catch($){throw console.error("Failed to update relationship:",$),s("Failed to update relationship"),$}finally{g(!1)}},deleteRelationship:async h=>{g(!0),b();try{await H.delete(h),i.value=i.value.filter(d=>d.id!==h)}catch(d){throw console.error("Failed to delete relationship:",d),s("Failed to delete relationship"),d}finally{g(!1)}},invalidateCache:()=>{f.value=null}}}),Te={class:"row items-center q-mb-md"},Ve={key:0,class:"text-center q-pa-md"},Le={key:1,class:"text-center q-pa-lg"},ze={key:2},Qe={class:"row items-center q-gutter-sm"},Ae={class:"col"},Ie={class:"text-body1"},Ee={class:"text-caption text-grey-6"},Se={key:0},Be={class:"row q-gutter-xs"},Ne={class:"text-h6"},Ue={class:"q-gutter-md"},Me={class:"q-ml-sm"},Oe={__name:"PersonRelationships",props:{personId:{type:String,required:!0},personName:{type:String,required:!0}},setup(i){const p=i,y=de(),w=ue(),f=Fe(),A=Q(()=>f.getRelationshipsForPerson(p.personId)),T=Q(()=>f.isLoading),D=q(!1),P=q(!1),g=q(!1),s=q(null),b=q(null),V=q([]),_=me({selectedPerson:null,relationshipType:"",description:""}),E=Q(()=>H.getRelationshipTypes()),S=async(t=!1)=>{try{await f.fetchAllRelationships(t)}catch(e){console.error("Error loading relationships:",e),y.notify({type:"negative",message:"Failed to load relationships",position:"top",timeout:3e3})}},B=async()=>{try{const t=w.peopleCount<=1;await w.fetchPeople(t);const e=w.getPeopleList;V.value=e.filter(r=>r.id!==p.personId)}catch(t){console.error("Error loading people:",t),y.notify({type:"negative",message:"Failed to load people list",position:"top",timeout:3e3})}},Y=(t,e)=>{e(()=>{const r=w.getPeopleList;if(t==="")V.value=r.filter(n=>n.id!==p.personId);else{const n=t.toLowerCase();V.value=r.filter(u=>u.id!==p.personId&&u.name.toLowerCase().includes(n))}})},h=t=>t.person1===p.personId?t.person2_name:t.person1_name,d=t=>{const e=E.value.find(r=>r.value===t);return e?e.label:t},$=t=>({partner:"favorite",family:"family_restroom",friend:"people",colleague:"work",acquaintance:"person",other:"help"})[t]||"person",I=t=>{s.value=t,_.selectedPerson=t.person1===p.personId?t.person2:t.person1,_.relationshipType=t.relationship_type,_.description=t.description||"",P.value=!0},N=t=>{b.value=t,g.value=!0},G=async()=>{if(!_.selectedPerson||!_.relationshipType){y.notify({type:"warning",message:"Please fill in all required fields",position:"top",timeout:3e3});return}D.value=!0;try{const t={person1:p.personId,person2:_.selectedPerson,relationship_type:_.relationshipType,description:_.description||""};s.value?(await f.updateRelationship(s.value.id,t),y.notify({type:"positive",message:"Relationship updated successfully",position:"top",timeout:3e3})):(await f.createRelationship(t),y.notify({type:"positive",message:"Relationship added successfully",position:"top",timeout:3e3})),J()}catch(t){console.error("Error saving relationship:",t),y.notify({type:"negative",message:`Failed to ${s.value?"update":"add"} relationship`,position:"top",timeout:3e3})}finally{D.value=!1}},W=async()=>{if(b.value)try{await f.deleteRelationship(b.value.id),y.notify({type:"positive",message:"Relationship deleted successfully",position:"top",timeout:3e3}),g.value=!1,b.value=null}catch(t){console.error("Error deleting relationship:",t),y.notify({type:"negative",message:"Failed to delete relationship",position:"top",timeout:3e3})}},X=async()=>{await j(),P.value=!0},j=async()=>{V.value.length<1&&await B()},J=()=>{P.value=!1,s.value=null,_.selectedPerson=null,_.relationshipType="",_.description=""};return ne(()=>p.personId,(t,e)=>{t&&t!==e&&!f.isCacheValid&&S()},{immediate:!1}),ie(()=>{(!f.isCacheValid||f.relationshipsCount===0)&&S(),B()}),(t,e)=>{const r=ve("router-link");return c(),O(L,{class:"content-card",flat:"",bordered:""},{default:l(()=>[o(F,{class:"q-pa-lg"},{default:l(()=>[a("div",Te,[e[6]||(e[6]=a("div",{class:"text-h6 text-weight-medium col"},"Relationships",-1)),o(x,{outline:"",color:"primary",icon:"add",label:"Add Relationship",size:"sm",onClick:X})]),T.value?(c(),m("div",Ve,[o(Z,{size:"30px",color:"primary"}),e[7]||(e[7]=a("div",{class:"q-mt-sm text-grey-6"},"Loading relationships...",-1))])):A.value.length===0?(c(),m("div",Le,[o(C,{name:"people_outline",size:"48px",color:"grey-5"}),e[8]||(e[8]=a("div",{class:"text-body2 text-grey-6 q-mt-sm"},"No relationships recorded",-1))])):(c(),m("div",ze,[(c(!0),m(re,null,ce(A.value,n=>(c(),m("div",{key:n.id,class:"relationship-item q-mb-md"},[a("div",Qe,[o(C,{name:$(n.relationship_type),size:"20px",color:"grey-7"},null,8,["name"]),a("div",Ae,[a("div",Ie,[o(r,{to:{name:"person-detail",params:{id:h(n)===n.person1_name?n.person1:n.person2}}},{default:l(()=>[k(v(h(n)),1)]),_:2},1032,["to"])]),a("div",Ee,[k(v(d(n.relationship_type))+" ",1),n.description?(c(),m("span",Se," • "+v(n.description),1)):R("",!0)])]),a("div",Be,[o(x,{flat:"",dense:"",round:"",size:"sm",icon:"edit",color:"grey-6",onClick:u=>I(n)},{default:l(()=>[o(K,null,{default:l(()=>[...e[9]||(e[9]=[k("Edit",-1)])]),_:1})]),_:2},1032,["onClick"]),o(x,{flat:"",dense:"",round:"",size:"sm",icon:"delete",color:"grey-6",onClick:u=>N(n)},{default:l(()=>[o(K,null,{default:l(()=>[...e[10]||(e[10]=[k("Delete",-1)])]),_:1})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1}),o(ee,{modelValue:P.value,"onUpdate:modelValue":e[3]||(e[3]=n=>P.value=n)},{default:l(()=>[o(L,{style:{"min-width":"400px"}},{default:l(()=>[o(F,null,{default:l(()=>[a("div",Ne,v(s.value?"Edit Relationship":"Add Relationship"),1)]),_:1}),o(F,{class:"q-pt-none"},{default:l(()=>[a("div",Ue,[o(ae,{modelValue:_.selectedPerson,"onUpdate:modelValue":e[0]||(e[0]=n=>_.selectedPerson=n),options:V.value,"option-label":"name","option-value":"id",label:"Person *",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",clearable:"",autofocus:"","emit-value":"","map-options":"",onFilter:Y,onPopupShow:j,rules:[n=>!!n||"Person is required"]},{"no-option":l(()=>[o(we,null,{default:l(()=>[o(xe,{class:"text-grey"},{default:l(()=>[k(v(V.value.length===0?"Loading people...":"No people found"),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"]),o(ae,{modelValue:_.relationshipType,"onUpdate:modelValue":e[1]||(e[1]=n=>_.relationshipType=n),options:E.value,label:"Relationship Type *",filled:"","emit-value":"","map-options":"",rules:[n=>!!n||"Relationship type is required"]},null,8,["modelValue","options","rules"]),o(ye,{modelValue:_.description,"onUpdate:modelValue":e[2]||(e[2]=n=>_.description=n),label:"Description",hint:"e.g., 'college roommate', 'sister-in-law'",filled:"",autocomplete:"off"},null,8,["modelValue"])])]),_:1}),o(te,{align:"right"},{default:l(()=>[o(x,{flat:"",label:"Cancel",color:"grey-7",onClick:J}),o(x,{flat:"",label:s.value?"Save Changes":"Add Relationship",color:"primary",loading:D.value,onClick:G},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ee,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=n=>g.value=n)},{default:l(()=>[o(L,null,{default:l(()=>[o(F,{class:"row items-center"},{default:l(()=>[o(oe,{icon:"warning",color:"negative","text-color":"white"}),a("span",Me,[e[11]||(e[11]=k(" Are you sure you want to delete the relationship with ",-1)),a("strong",null,v(b.value?.person1_name===i.personName?b.value?.person2_name:b.value?.person1_name),1),e[12]||(e[12]=k("? ",-1))])]),_:1}),o(te,{align:"right"},{default:l(()=>[o(x,{flat:"",label:"Cancel",color:"primary",onClick:e[4]||(e[4]=n=>g.value=!1)}),o(x,{flat:"",label:"Delete",color:"negative",onClick:W})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},He=le(Oe,[["__scopeId","data-v-0bbc5049"]]),Ye={key:0,class:"text-center q-pa-xl"},je={key:1,class:"text-center q-pa-xl"},Je={class:"text-h6 text-negative q-mt-md"},Ke={key:2,class:"text-center q-pa-xl"},Ge={key:3,class:"person-detail-container"},We={class:"breadcrumb-nav q-mb-md"},Xe={class:"row items-start q-gutter-md"},Ze={class:"col"},et={class:"text-h4 q-mb-sm text-weight-medium"},tt={key:0,class:"text-h6 text-grey-7 q-mb-md"},ot={class:"text-body2 text-grey-6"},st={key:0},at={class:"col-auto"},lt={class:"action-buttons"},nt={class:"row q-col-gutter-lg"},it={class:"col-12 col-md-6"},rt={key:0,class:"contact-item q-mb-md"},ct={class:"row items-center q-gutter-sm"},dt={class:"col text-body1"},ut={key:1,class:"contact-item q-mb-md"},pt={class:"row items-center q-gutter-sm"},mt={class:"col text-body1"},vt={key:2,class:"contact-item q-mb-md"},yt={class:"row items-center q-gutter-sm"},ft={class:"col text-body1"},ht={key:3,class:"contact-item q-mb-md"},gt={class:"row items-center q-gutter-sm"},_t={class:"col"},wt={class:"text-body1"},xt={key:4,class:"contact-item q-mb-md"},bt={class:"row items-center q-gutter-sm"},qt={class:"col"},Ct={key:5,class:"contact-item"},kt={class:"row items-start q-gutter-sm"},Rt={class:"col q-ml-sm"},Dt={class:"text-body2 text-grey-7"},Pt={class:"text-body1 text-grey-8 pre-line"},$t={class:"col-12 col-md-6"},Ft={class:"text-body1 text-grey-8 pre-line ai-summary-text"},Tt={key:0,class:"text-center q-pa-md"},Vt={key:1,class:"text-center q-pa-md"},Lt={key:2,class:"conversations-scroll-container"},zt=["onClick"],Qt={class:"row items-start q-gutter-sm"},At={class:"col"},It={class:"text-body2 text-weight-medium q-mb-xs"},Et={key:0},St={class:"text-caption text-grey-6 q-mb-xs"},Bt={class:"text-body2 text-grey-7 conversation-preview"},Nt={class:"q-ml-sm"},Ut={__name:"PersonDetailView",setup(i){const p=fe(),y=he(),w=de(),f=ue(),A=De(),T=q(!1),D=q(!1),P=q(!1),g=q([]),s=Q(()=>f.selectedPerson),b=async()=>{const t=p.params.id;if(t)try{await f.fetchPersonById(t),await V()}catch(e){console.error("Failed to load person:",e)}},V=async()=>{if(s.value){P.value=!0,g.value=[];try{const t=await A.fetchConversationsForPerson(s.value.id);g.value=t||[]}catch(t){console.error("Failed to load conversations:",t),g.value=[]}finally{P.value=!1}}},_=()=>{y.push({name:"people"})},E=()=>{s.value&&y.push({name:"person-edit",params:{id:s.value.id}})},S=async()=>{if(s.value)try{const t=s.value.name;await f.deletePerson(s.value.id),D.value=!1,w.notify({type:"negative",message:`${t} deleted successfully`,position:"top",timeout:4e3,actions:[{icon:"close",color:"white",dense:!0}]}),y.push({name:"people"})}catch(t){console.error("Failed to delete person:",t),w.notify({type:"negative",message:"Failed to delete person. Please try again.",position:"top",timeout:4e3})}},B=async()=>{if(s.value?.email)try{await navigator.clipboard.writeText(s.value.email),w.notify({type:"positive",message:`Email copied: ${s.value.email}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(t){console.error("Failed to copy email:",t),w.notify({type:"negative",message:"Failed to copy email address",position:"top",timeout:3e3})}},Y=async()=>{if(s.value?.phone)try{await navigator.clipboard.writeText(s.value.phone),w.notify({type:"positive",message:`Phone number copied: ${s.value.phone}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(t){console.error("Failed to copy phone number:",t),w.notify({type:"negative",message:"Failed to copy phone number",position:"top",timeout:3e3})}},h=()=>{s.value&&y.push({name:"conversation-create",query:{participants:s.value.id}})},d=()=>{s.value&&y.push({name:"contact-attempt-create",query:{person:s.value.id}})},$=t=>{if(!t)return"Never";const e=new Date(t),n=new Date-e,u=Math.floor(n/(1e3*60*60*24));if(u===0)return"Today";if(u===1)return"Yesterday";if(u<7)return u===1?"1 day ago":`${u} days ago`;if(u<30){const U=Math.floor(u/7);return U===1?"1 week ago":`${U} weeks ago`}if(u<365){const U=Math.floor(u/30);return U===1?"1 month ago":`${U} months ago`}return e.toLocaleDateString()},I=t=>t?new Date(t).toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}):"",N=t=>{if(!t)return"";const e=new Date(t),n=new Date-e,u=Math.floor(n/(1e3*60*60*24));return u===0?"Today":u===1?"Yesterday":u<7?`${u} days ago`:e.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})},G=(t,e)=>!t||t.length<=e?t:t.substring(0,e).trim()+"...",W=t=>({in_person:"primary",phone:"positive",text:"info",email:"secondary",video:"accent",other:"grey-6"})[t]||"grey-6",X=t=>{y.push({name:"conversation-detail",params:{id:t.id}})},j=t=>{if(!t)return"grey-6";const e=new Date(t),n=new Date-e,u=Math.floor(n/(1e3*60*60*24));return u<=60?"positive":u<=180?"grey-7":"negative"},J=t=>{if(!t)return"text-grey-6";const e=new Date(t),n=new Date-e,u=Math.floor(n/(1e3*60*60*24));return u<=60?"text-positive":u<=180?"text-grey-8":"text-negative"};return ne(()=>p.params.id,(t,e)=>{t&&t!==e&&(g.value=[],b())}),ie(()=>{b()}),(t,e)=>(c(),O(be,{view:"lHh Lpr lFf"},{default:l(()=>[o(qe,{onToggleDrawer:e[0]||(e[0]=r=>T.value=!T.value)}),o(Ce,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=r=>T.value=r)},null,8,["modelValue"]),o(ke,null,{default:l(()=>[o(Re,{class:"q-pa-md",style:{"background-color":"#f8f9fa"}},{default:l(()=>[M(f).isLoading?(c(),m("div",Ye,[o(Z,{size:"50px",color:"primary"}),e[5]||(e[5]=a("div",{class:"q-mt-md"},"Loading person details...",-1))])):M(f).hasError?(c(),m("div",je,[o(C,{name:"error_outline",size:"80px",color:"negative"}),a("div",Je,v(M(f).error),1),o(x,{color:"primary",label:"Try Again",class:"q-mt-md",onClick:b})])):s.value?(c(),m("div",Ge,[a("div",We,[o(_e,{class:"text-grey-6"},{default:l(()=>[o(se,{icon:"people",label:"People",onClick:_,class:"cursor-pointer"}),o(se,{label:s.value.name},null,8,["label"])]),_:1})]),o(L,{class:"header-card q-mb-lg",flat:""},{default:l(()=>[o(F,{class:"q-pa-lg"},{default:l(()=>[a("div",Xe,[a("div",Ze,[a("div",et,v(s.value.name),1),s.value.name_ext?(c(),m("div",tt,v(s.value.name_ext),1)):R("",!0),a("div",ot,[o(C,{name:"schedule",size:"16px",class:"q-mr-xs"}),k(" Added "+v($(s.value.created_at))+" ",1),s.value.created_by_username?(c(),m("span",st," by "+v(s.value.created_by_username),1)):R("",!0)])]),a("div",at,[a("div",lt,[o(x,{color:"secondary",icon:"chat_bubble",label:"Log Conversation",class:"q-mr-sm",onClick:h}),o(x,{outline:"",color:"secondary",icon:"contact_phone",label:"Ping",class:"q-mr-sm",onClick:d}),o(x,{outline:"",color:"primary",icon:"edit",label:"Edit",class:"q-mr-sm",onClick:E}),o(x,{outline:"",color:"negative",icon:"delete",label:"Delete",onClick:e[2]||(e[2]=r=>D.value=!0)})])])])]),_:1})]),_:1}),a("div",nt,[a("div",it,[o(L,{class:"content-card q-mb-lg",flat:"",bordered:""},{default:l(()=>[o(F,{class:"q-pa-lg"},{default:l(()=>[e[11]||(e[11]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Contact Information",-1)),s.value.location?(c(),m("div",rt,[a("div",ct,[o(C,{name:"place",size:"20px",color:"grey-7"}),a("div",dt,v(s.value.location),1)])])):R("",!0),s.value.email?(c(),m("div",ut,[a("div",pt,[o(C,{name:"email",size:"20px",color:"grey-7"}),a("div",mt,v(s.value.email),1),o(x,{unelevated:"",size:"sm",icon:"content_copy",color:"info","text-color":"white",onClick:B,class:"contact-action-btn"},{default:l(()=>[o(K,null,{default:l(()=>[...e[7]||(e[7]=[k("Copy Email",-1)])]),_:1})]),_:1})])])):R("",!0),s.value.phone?(c(),m("div",vt,[a("div",yt,[o(C,{name:"phone",size:"20px",color:"grey-7"}),a("div",ft,v(s.value.phone),1),o(x,{unelevated:"",size:"sm",icon:"content_copy",color:"info","text-color":"white",onClick:Y,class:"contact-action-btn"},{default:l(()=>[o(K,null,{default:l(()=>[...e[8]||(e[8]=[k("Copy Phone",-1)])]),_:1})]),_:1})])])):R("",!0),s.value.birthday?(c(),m("div",ht,[a("div",gt,[o(C,{name:"cake",size:"20px",color:"grey-7"}),a("div",_t,[a("div",wt,v(I(s.value.birthday)),1),e[9]||(e[9]=a("div",{class:"text-caption text-grey-6"},"Birthday",-1))])])])):R("",!0),s.value.last_contacted?(c(),m("div",xt,[a("div",bt,[o(C,{name:"schedule",size:"20px",color:j(s.value.last_contacted)},null,8,["color"]),a("div",qt,[a("div",{class:ge(["text-body1",J(s.value.last_contacted)])},v($(s.value.last_contacted)),3),e[10]||(e[10]=a("div",{class:"text-caption text-grey-6"},"Last Contact",-1))])])])):R("",!0),s.value.how_we_met?(c(),m("div",Ct,[a("div",kt,[o(C,{name:"handshake",size:"18px",color:"grey-6"}),a("div",Rt,[a("div",Dt,v(s.value.how_we_met),1)])])])):R("",!0)]),_:1})]),_:1}),s.value.notes?(c(),O(L,{key:0,class:"content-card q-mb-lg",flat:"",bordered:""},{default:l(()=>[o(F,{class:"q-pa-lg"},{default:l(()=>[e[12]||(e[12]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Notes",-1)),a("div",Pt,v(s.value.notes),1)]),_:1})]),_:1})):R("",!0),(c(),O(He,{key:s.value.id,"person-id":s.value.id,"person-name":s.value.name},null,8,["person-id","person-name"]))]),a("div",$t,[s.value.ai_summary?(c(),O(L,{key:0,class:"content-card q-mb-lg",flat:"",bordered:""},{default:l(()=>[o(F,{class:"q-pa-lg"},{default:l(()=>[e[13]||(e[13]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Conversation History",-1)),a("div",Ft,v(s.value.ai_summary),1)]),_:1})]),_:1})):R("",!0),o(L,{class:"content-card q-mb-lg",flat:"",bordered:""},{default:l(()=>[o(F,{class:"q-pa-lg"},{default:l(()=>[e[16]||(e[16]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Conversations",-1)),P.value?(c(),m("div",Tt,[o(Z,{size:"20px",color:"primary"}),e[14]||(e[14]=a("div",{class:"text-caption text-grey-6 q-mt-sm"},"Loading conversations...",-1))])):g.value.length===0?(c(),m("div",Vt,[o(C,{name:"chat_bubble_outline",size:"32px",color:"grey-4"}),e[15]||(e[15]=a("div",{class:"text-body2 text-grey-6 q-mt-sm"},"No conversations recorded yet",-1))])):(c(),m("div",Lt,[(c(!0),m(re,null,ce(g.value,r=>(c(),m("div",{key:r.id,class:"conversation-timeline-item q-mb-sm cursor-pointer",onClick:n=>X(r)},[a("div",Qt,[o(oe,{size:"32px",color:W(r.type),"text-color":"white"},{default:l(()=>[o(C,{name:M(Pe)(r.type),size:"16px"},null,8,["name"])]),_:2},1032,["color"]),a("div",At,[a("div",It,[k(v(M($e)(r.type))+" ",1),r.location?(c(),m("span",Et," • "+v(r.location),1)):R("",!0)]),a("div",St,v(N(r.date)),1),a("div",Bt,v(G(r.notes,100)),1)]),o(C,{name:"chevron_right",color:"grey-4",size:"16px"})])],8,zt))),128))]))]),_:1})]),_:1})])])])):(c(),m("div",Ke,[o(C,{name:"person_off",size:"80px",color:"grey-5"}),e[6]||(e[6]=a("div",{class:"text-h6 text-grey-7 q-mt-md"}," Person not found ",-1)),o(x,{color:"primary",label:"Back to People",class:"q-mt-md",onClick:_})])),o(ee,{modelValue:D.value,"onUpdate:modelValue":e[4]||(e[4]=r=>D.value=r)},{default:l(()=>[o(L,null,{default:l(()=>[o(F,{class:"row items-center"},{default:l(()=>[o(oe,{icon:"warning",color:"negative","text-color":"white"}),a("span",Nt,[e[17]||(e[17]=k(" Are you sure you want to delete ",-1)),a("strong",null,v(s.value?.name),1),e[18]||(e[18]=k("? This action cannot be undone. ",-1))])]),_:1}),o(te,{align:"right"},{default:l(()=>[o(x,{flat:"",label:"Cancel",color:"primary",onClick:e[3]||(e[3]=r=>D.value=!1)}),o(x,{flat:"",label:"Delete",color:"negative",onClick:S})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},Zt=le(Ut,[["__scopeId","data-v-d9db2923"]]);export{Zt as default};
