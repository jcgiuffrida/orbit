import{_ as O,c as F,r as I,a as i,o as l,b as s,d as q,e as R,f,g as W,w as e,Q as H,h as t,i as D,t as d,j as y,k as _,l as m,u as w,m as g,n as r,F as Q,p as $,q as S,s as z}from"./main-BNYyCrAV.js";import{Q as N}from"./QTooltip-DaHthXlo.js";import{Q as A}from"./QItemLabel-Co7gJjbr.js";import{u as M,_ as U,a as Y,Q as j,b as E,c as V,d as T,e as L,f as G}from"./NavigationDrawer-CoZBpgI1.js";import"./position-engine--pu8bc_Q.js";const J={class:"monthly-chart"},K={key:0,class:"text-body2 text-grey-6 text-center q-pa-lg"},X={key:1},Z={__name:"ActivityChart",props:{data:{type:Array,default:()=>[]}},setup(k){const c=k,h=F(()=>{if(!c.data||c.data.length===0)return{};const n=c.data.map(v=>v.month_name),x=c.data.map(v=>v.conversations),p=c.data.map(v=>v.contact_attempts);return{chart:{type:"line",backgroundColor:"transparent",spacingTop:20,spacingBottom:20,spacingLeft:20,spacingRight:20},title:{text:null},xAxis:{categories:n,lineColor:"#e0e0e0",tickColor:"#e0e0e0",labels:{style:{color:"#666",fontSize:"12px"}}},yAxis:{title:{text:"Count",style:{color:"#666"}},min:0,gridLineColor:"#f0f0f0",labels:{style:{color:"#666",fontSize:"12px"}}},tooltip:{shared:!0,backgroundColor:"#ffffff",borderColor:"#e0e0e0",borderRadius:8,shadow:!0,useHTML:!0,formatter:function(){let C=`<div style="text-align: center; margin-bottom: 5px; font-weight: bold;">${this.points&&this.points.length>0?this.points[0].category:this.x}</div>`;return this.points&&this.points.forEach(b=>{C+=`<div style="margin: 2px 0;"><span style="color:${b.color}; font-size: 14px;">‚óè</span> ${b.series.name}: <b>${b.y}</b></div>`}),C}},legend:{align:"center",verticalAlign:"bottom",borderWidth:0,itemStyle:{color:"#666",fontSize:"12px"}},plotOptions:{line:{lineWidth:3,states:{hover:{lineWidth:4}}}},series:[{name:"Conversations",data:x,color:"#1976d2",marker:{fillColor:"#1976d2"}},{name:"Pings",data:p,color:"#424242",marker:{fillColor:"#424242"}}],credits:{enabled:!1},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"},xAxis:{labels:{rotation:-45,style:{fontSize:"10px"}}}}}]}}});return(n,x)=>{const p=I("highcharts");return l(),i("div",J,[!k.data||k.data.length===0?(l(),i("div",K," No activity data available ")):(l(),i("div",X,[s(p,{options:h.value,style:{height:"400px",width:"100%"}},null,8,["options"])]))])}}},tt=O(Z,[["__scopeId","data-v-64cbd7e6"]]),et={key:0,class:"flex flex-center q-mt-lg"},st={key:1,class:"text-center q-mt-lg"},ot={class:"text-body2"},at={key:2},lt={class:"row items-center q-mb-lg"},nt={class:"col-auto"},it={class:"q-gutter-sm"},dt={class:"row q-mb-lg"},rt={class:"col-12"},ct={class:"row q-mb-lg"},ut={class:"col-12"},_t={class:"row q-col-gutter-md"},vt={class:"col"},mt={class:"text-h6"},pt={key:0,class:"text-body2"},ft={class:"col"},yt={class:"text-h6"},gt={key:0,class:"text-body2"},ht={class:"col"},xt={class:"text-h6"},wt={key:0,class:"text-body2"},bt={class:"row q-col-gutter-md q-mb-lg"},kt={class:"col-12 col-md-6"},Ct={class:"col-12 col-md-6"},qt={key:0,class:"row q-mb-lg"},Qt={class:"col-12"},$t={class:"row items-center"},At={class:"col-auto"},Pt={class:"row q-col-gutter-md"},Dt=["onClick"],zt={class:"row items-center q-gutter-sm"},Nt={class:"col-auto"},St={class:"col"},Vt={key:0,class:"text-weight-bold"},Tt={key:1},Lt={key:2},Bt={key:3,class:"q-ml-sm"},Ot={class:"row"},Ft={class:"col-12"},It={class:"row q-col-gutter-md"},Rt={class:"text-h6"},Wt={key:0,class:"text-caption text-grey-6"},Et={__name:"HomeView",setup(k){const c=M(),h=q(!1),n=q({}),x=q(!0),p=q(null),v=async()=>{try{x.value=!0,p.value=null;const u=await W.get("/dashboard/");n.value=u.data}catch(u){p.value=u.response?.data?.detail||"Failed to load dashboard data",console.error("Dashboard load error:",u)}finally{x.value=!1}},C=u=>new Date(u).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),b=(u,o,a)=>u===1?o:a,B=u=>{router.push({name:"person-detail",params:{id:u}})};return R(()=>{v()}),(u,o)=>(l(),f(G,{view:"lHh Lpr lFf"},{default:e(()=>[s(U,{onToggleDrawer:o[0]||(o[0]=a=>h.value=!h.value)}),s(Y,{modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=a=>h.value=a)},null,8,["modelValue"]),s(j,null,{default:e(()=>[s(E,{class:"q-pa-md"},{default:e(()=>[x.value?(l(),i("div",et,[s(H,{size:"2em"})])):p.value?(l(),i("div",st,[s(D,{name:"error",size:"2em",color:"negative"}),o[3]||(o[3]=t("div",{class:"text-h6 q-mt-md"},"Failed to load dashboard",-1)),t("div",ot,d(p.value),1),s(y,{onClick:v,color:"primary",class:"q-mt-md"},{default:e(()=>[...o[2]||(o[2]=[_("Retry",-1)])]),_:1})])):(l(),i("div",at,[t("div",lt,[o[7]||(o[7]=t("div",{class:"col"},[t("h1",{class:"text-h4 q-ma-none"},"Dashboard")],-1)),t("div",nt,[t("div",it,[s(y,{color:"accent",icon:"add_comment",to:{name:"conversation-create"},label:w(c).screen.gt.xs?"New Conversation":void 0},{default:e(()=>[w(c).screen.gt.xs?m("",!0):(l(),f(N,{key:0},{default:e(()=>[...o[4]||(o[4]=[_("New Conversation",-1)])]),_:1}))]),_:1},8,["label"]),s(y,{color:"secondary",icon:"contact_phone",to:{name:"ping-create"},label:w(c).screen.gt.xs?"New Ping":void 0},{default:e(()=>[w(c).screen.gt.xs?m("",!0):(l(),f(N,{key:0},{default:e(()=>[...o[5]||(o[5]=[_("New Ping",-1)])]),_:1}))]),_:1},8,["label"]),s(y,{color:"primary",icon:"person_add",to:{name:"person-edit",params:{id:"new"}},label:w(c).screen.gt.xs?"Add Person":void 0},{default:e(()=>[w(c).screen.gt.xs?m("",!0):(l(),f(N,{key:0},{default:e(()=>[...o[6]||(o[6]=[_("Add Person",-1)])]),_:1}))]),_:1},8,["label"])])])]),t("div",dt,[t("div",rt,[s(g,null,{default:e(()=>[s(r,null,{default:e(()=>[...o[8]||(o[8]=[t("div",{class:"text-h6"},"Activity Over Past Year",-1)])]),_:1}),s(r,null,{default:e(()=>[s(tt,{data:n.value.monthly_activity},null,8,["data"])]),_:1})]),_:1})])]),t("div",ct,[t("div",ut,[s(g,null,{default:e(()=>[s(r,null,{default:e(()=>[...o[9]||(o[9]=[t("div",{class:"text-h6"},"Activity Overview",-1)])]),_:1}),s(r,null,{default:e(()=>[t("div",_t,[t("div",vt,[o[10]||(o[10]=t("div",{class:"text-caption"},"Past Week",-1)),t("div",mt,d(n.value.activity_overview.conversations.week)+" conversations",1),n.value.activity_overview.contact_attempts.week>0?(l(),i("div",pt,"+ "+d(n.value.activity_overview.contact_attempts.week)+" pings",1)):m("",!0)]),t("div",ft,[o[11]||(o[11]=t("div",{class:"text-caption"},"Past Month",-1)),t("div",yt,d(n.value.activity_overview.conversations.month)+" conversations",1),n.value.activity_overview.contact_attempts.month>0?(l(),i("div",gt,"+ "+d(n.value.activity_overview.contact_attempts.month)+" pings",1)):m("",!0)]),t("div",ht,[o[12]||(o[12]=t("div",{class:"text-caption"},"Past Year",-1)),t("div",xt,d(n.value.activity_overview.conversations.year)+" conversations",1),n.value.activity_overview.contact_attempts.year>0?(l(),i("div",wt,"+ "+d(n.value.activity_overview.contact_attempts.year)+" pings",1)):m("",!0)])])]),_:1})]),_:1})])]),t("div",bt,[t("div",kt,[s(g,null,{default:e(()=>[s(r,null,{default:e(()=>[...o[13]||(o[13]=[t("div",{class:"text-h6"},"Recent Conversations",-1)])]),_:1}),s(r,null,{default:e(()=>[s(V,{separator:""},{default:e(()=>[(l(!0),i(Q,null,$(n.value.recent_conversations.slice(0,8),a=>(l(),f(T,{key:a.id,to:{name:"conversation-detail",params:{id:a.id}},clickable:""},{default:e(()=>[s(L,null,{default:e(()=>[s(A,null,{default:e(()=>[_(d(C(a.date)),1)]),_:2},1024),s(A,{caption:""},{default:e(()=>[_(d(a.participants.map(P=>P.name).join(", ")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1}),s(S,{align:"center"},{default:e(()=>[s(y,{flat:"",to:{name:"conversations"}},{default:e(()=>[...o[14]||(o[14]=[_("View all",-1)])]),_:1})]),_:1})]),_:1})]),t("div",Ct,[s(g,null,{default:e(()=>[s(r,null,{default:e(()=>[...o[15]||(o[15]=[t("div",{class:"text-h6"},"Top Contacts",-1),t("div",{class:"text-subtitle2"},"Past two years",-1)])]),_:1}),s(r,null,{default:e(()=>[s(V,{separator:""},{default:e(()=>[(l(!0),i(Q,null,$(n.value.top_contacts.slice(0,8),a=>(l(),f(T,{key:a.id,to:{name:"person-detail",params:{id:a.id}},clickable:""},{default:e(()=>[s(L,null,{default:e(()=>[s(A,null,{default:e(()=>[_(d(a.name),1)]),_:2},1024),s(A,{caption:""},{default:e(()=>[_(d(a.conversation_count_recent)+" "+d(b(a.conversation_count_recent,"conversation","conversations")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1}),s(S,{align:"center"},{default:e(()=>[s(y,{flat:"",to:{name:"people"}},{default:e(()=>[...o[16]||(o[16]=[_("View all",-1)])]),_:1})]),_:1})]),_:1})])]),n.value.upcoming_birthdays&&n.value.upcoming_birthdays.length>0?(l(),i("div",qt,[t("div",Qt,[s(g,null,{default:e(()=>[s(r,null,{default:e(()=>[t("div",$t,[o[18]||(o[18]=t("div",{class:"col"},[t("div",{class:"text-h6"}," Upcoming Birthdays ")],-1)),t("div",At,[s(y,{flat:"",dense:"",to:{name:"birthdays"},color:"primary"},{default:e(()=>[o[17]||(o[17]=_(" View Calendar ",-1)),s(D,{name:"chevron_right"})]),_:1})])])]),_:1}),s(r,null,{default:e(()=>[t("div",Pt,[(l(!0),i(Q,null,$(n.value.upcoming_birthdays.slice(0,6),a=>(l(),i("div",{key:a.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[t("div",{class:z(["birthday-item q-pa-sm rounded-borders cursor-pointer",{"bg-accent text-white":a.is_today,"bg-grey-3":!a.is_today}]),onClick:P=>B(a.id)},[t("div",zt,[t("div",Nt,[s(D,{name:a.is_today?"celebration":"cake",size:"24px",color:a.is_today?"white":"primary"},null,8,["name","color"])]),t("div",St,[t("div",{class:z([a.is_today?"text-white":"text-body1","text-weight-medium"])},d(a.name),3),t("div",{class:z(a.is_today?"text-white":"text-caption text-grey-6")},[a.is_today?(l(),i("span",Vt,"Today!")):a.days_until===1?(l(),i("span",Tt,"Tomorrow")):(l(),i("span",Lt,d(a.days_until)+" days",1)),a.age?(l(),i("span",Bt,"("+d(a.age)+")",1)):m("",!0)],2)])])],10,Dt)]))),128))])]),_:1})]),_:1})])])):m("",!0),t("div",Ot,[t("div",Ft,[s(g,null,{default:e(()=>[s(r,null,{default:e(()=>[...o[19]||(o[19]=[t("div",{class:"text-h6"},"People to Reach Out",-1)])]),_:1}),n.value.people_to_reach_out.length===0?(l(),f(r,{key:0},{default:e(()=>[...o[20]||(o[20]=[t("div",{class:"text-body2 text-grey-6"},"Great! You're up to date with everyone.",-1)])]),_:1})):(l(),f(r,{key:1},{default:e(()=>[t("div",It,[(l(!0),i(Q,null,$(n.value.people_to_reach_out,a=>(l(),i("div",{key:a.id,class:"col-12 col-sm-6 col-md-4"},[s(g,{class:"cursor-pointer",onClick:P=>u.$router.push({name:"person-detail",params:{id:a.id}})},{default:e(()=>[s(r,null,{default:e(()=>[t("div",Rt,d(a.name),1),a.days_since_last_contact?(l(),i("div",Wt,d(a.days_since_last_contact)+" days ago ",1)):m("",!0)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])]),_:1}))]),_:1})])])]))]),_:1})]),_:1})]),_:1}))}};export{Et as default};
