import{Q as X}from"./QSpinnerDots-COME6D_6.js";import{g as Q,H as ue,d as C,c as A,_ as ae,I as pe,J as le,e as ne,r as me,f as O,o as d,w as i,b as t,n as T,h as a,a as u,j as x,i as q,F as ie,p as re,k,t as m,l as R,K as Z,m as z,D as ve,q as ee,L as te,M as ye,C as fe,u as S,E as he}from"./main-BSNfDbTQ.js";import{Q as ge,a as oe}from"./QBreadcrumbs-CdOISPkB.js";import{Q as J}from"./QTooltip-BTYvVAAz.js";import{u as de,d as _e,e as we,f as xe,_ as be,a as qe,Q as Ce,b as ke}from"./NavigationDrawer-Cd3a0AvU.js";import{u as ce}from"./people-BTbzMQ5w.js";import{u as Re,g as Pe,a as De,b as $e}from"./conversations-I7sj76Kg.js";import{Q as se}from"./QSelect-wSek9BIm.js";import"./QItemLabel-CDBU9do_.js";import"./QChip-CiA8MApy.js";const H={async getAll(){return(await Q.get("relationships/")).data},async getByPerson(r){const p=await Q.get("relationships/");return(p.data.results||p.data).filter(_=>_.person1===r||_.person2===r)},async getById(r){return(await Q.get(`relationships/${r}/`)).data},async create(r){return(await Q.post("relationships/",r)).data},async update(r,p){return(await Q.put(`relationships/${r}/`,p)).data},async partialUpdate(r,p){return(await Q.patch(`relationships/${r}/`,p)).data},async delete(r){return await Q.delete(`relationships/${r}/`),!0},getRelationshipTypes(){return[{label:"Partner",value:"partner"},{label:"Family",value:"family"},{label:"Friend",value:"friend"},{label:"Colleague",value:"colleague"},{label:"Acquaintance",value:"acquaintance"},{label:"Other",value:"other"}]}},Fe=ue("relationships",()=>{const r=C([]),p=C(!1),v=C(!1),_=C(null),y=C(null),I=1800*1e3,V=A(()=>y.value?Date.now()-y.value<I:!1),P=A(()=>r.value),D=A(()=>r.value.length),h=f=>{p.value=f,f&&(v.value=!1,_.value=null)},o=f=>{v.value=!0,_.value=f,p.value=!1},b=()=>{v.value=!1,_.value=null};return{relationships:r,isLoading:p,hasError:v,error:_,getRelationshipsList:P,relationshipsCount:D,isCacheValid:V,fetchAllRelationships:async(f=!1)=>{if(!f&&V.value&&r.value.length>0)return r.value;h(!0),b();try{const c=await H.getAll();return r.value=c.results||c,y.value=Date.now(),r.value}catch(c){throw console.error("Failed to fetch relationships:",c),o("Failed to load relationships"),c}finally{h(!1)}},getRelationshipsForPerson:f=>r.value.filter(c=>c.person1===f||c.person2===f),createRelationship:async f=>{h(!0),b();try{const c=await H.create(f);return r.value.push(c),y.value=Date.now(),c}catch(c){throw console.error("Failed to create relationship:",c),o("Failed to create relationship"),c}finally{h(!1)}},updateRelationship:async(f,c)=>{h(!0),b();try{const $=await H.update(f,c),E=r.value.findIndex(M=>M.id===f);return E>=0&&(r.value[E]=$),$}catch($){throw console.error("Failed to update relationship:",$),o("Failed to update relationship"),$}finally{h(!1)}},deleteRelationship:async f=>{h(!0),b();try{await H.delete(f),r.value=r.value.filter(c=>c.id!==f)}catch(c){throw console.error("Failed to delete relationship:",c),o("Failed to delete relationship"),c}finally{h(!1)}},invalidateCache:()=>{y.value=null}}}),Te={class:"row items-center q-mb-md"},Ve={key:0,class:"text-center q-pa-md"},Le={key:1,class:"text-center q-pa-lg"},ze={key:2},Qe={class:"row items-center q-gutter-sm"},Ae={class:"col"},Ie={class:"text-body1"},Ee={class:"text-caption text-grey-6"},Se={key:0},Be={class:"row q-gutter-xs"},Ne={class:"text-h6"},Ue={class:"q-gutter-md"},Me={class:"q-ml-sm"},Oe={__name:"PersonRelationships",props:{personId:{type:String,required:!0},personName:{type:String,required:!0}},setup(r){const p=r,v=de(),_=ce(),y=Fe(),I=A(()=>y.getRelationshipsForPerson(p.personId)),V=A(()=>y.isLoading),P=C(!1),D=C(!1),h=C(!1),o=C(null),b=C(null),L=C([]),g=pe({selectedPerson:null,relationshipType:"",description:""}),B=A(()=>H.getRelationshipTypes()),N=async(e=!1)=>{try{await y.fetchAllRelationships(e)}catch(s){console.error("Error loading relationships:",s),v.notify({type:"negative",message:"Failed to load relationships",position:"top",timeout:3e3})}},U=async()=>{try{const e=_.peopleCount<=1;await _.fetchPeople(e);const s=_.getPeopleList;L.value=s.filter(w=>w.id!==p.personId)}catch(e){console.error("Error loading people:",e),v.notify({type:"negative",message:"Failed to load people list",position:"top",timeout:3e3})}},Y=(e,s)=>{s(()=>{const w=_.getPeopleList;if(e==="")L.value=w.filter(l=>l.id!==p.personId);else{const l=e.toLowerCase();L.value=w.filter(F=>F.id!==p.personId&&F.name.toLowerCase().includes(l))}})},f=e=>e.person1===p.personId?e.person2_name:e.person1_name,c=e=>{const s=B.value.find(w=>w.value===e);return s?s.label:e},$=e=>({partner:"favorite",family:"family_restroom",friend:"people",colleague:"work",acquaintance:"person",other:"help"})[e]||"person",E=e=>{o.value=e,g.selectedPerson=e.person1===p.personId?e.person2:e.person1,g.relationshipType=e.relationship_type,g.description=e.description||"",D.value=!0},M=e=>{b.value=e,h.value=!0},K=async()=>{if(!g.selectedPerson||!g.relationshipType){v.notify({type:"warning",message:"Please fill in all required fields",position:"top",timeout:3e3});return}P.value=!0;try{const e={person1:p.personId,person2:g.selectedPerson,relationship_type:g.relationshipType,description:g.description||""};o.value?(await y.updateRelationship(o.value.id,e),v.notify({type:"positive",message:"Relationship updated successfully",position:"top",timeout:3e3})):(await y.createRelationship(e),v.notify({type:"positive",message:"Relationship added successfully",position:"top",timeout:3e3})),n()}catch(e){console.error("Error saving relationship:",e),v.notify({type:"negative",message:`Failed to ${o.value?"update":"add"} relationship`,position:"top",timeout:3e3})}finally{P.value=!1}},G=async()=>{if(b.value)try{await y.deleteRelationship(b.value.id),v.notify({type:"positive",message:"Relationship deleted successfully",position:"top",timeout:3e3}),h.value=!1,b.value=null}catch(e){console.error("Error deleting relationship:",e),v.notify({type:"negative",message:"Failed to delete relationship",position:"top",timeout:3e3})}},W=async()=>{await j(),D.value=!0},j=async()=>{L.value.length<1&&await U()},n=()=>{D.value=!1,o.value=null,g.selectedPerson=null,g.relationshipType="",g.description=""};return le(()=>p.personId,(e,s)=>{e&&e!==s&&!y.isCacheValid&&N()},{immediate:!1}),ne(()=>{(!y.isCacheValid||y.relationshipsCount===0)&&N(),U()}),(e,s)=>{const w=me("router-link");return d(),O(z,{class:"content-card",flat:"",bordered:""},{default:i(()=>[t(T,{class:"q-pa-lg"},{default:i(()=>[a("div",Te,[s[6]||(s[6]=a("div",{class:"text-h6 text-weight-medium col"},"Relationships",-1)),t(x,{outline:"",color:"primary",icon:"add",label:"Add Relationship",size:"sm",onClick:W})]),V.value?(d(),u("div",Ve,[t(X,{size:"30px",color:"primary"}),s[7]||(s[7]=a("div",{class:"q-mt-sm text-grey-6"},"Loading relationships...",-1))])):I.value.length===0?(d(),u("div",Le,[t(q,{name:"people_outline",size:"48px",color:"grey-5"}),s[8]||(s[8]=a("div",{class:"text-body2 text-grey-6 q-mt-sm"},"No relationships recorded",-1))])):(d(),u("div",ze,[(d(!0),u(ie,null,re(I.value,l=>(d(),u("div",{key:l.id,class:"relationship-item q-mb-md"},[a("div",Qe,[t(q,{name:$(l.relationship_type),size:"20px",color:"grey-7"},null,8,["name"]),a("div",Ae,[a("div",Ie,[t(w,{to:{name:"person-detail",params:{id:f(l)===l.person1_name?l.person1:l.person2}}},{default:i(()=>[k(m(f(l)),1)]),_:2},1032,["to"])]),a("div",Ee,[k(m(c(l.relationship_type))+" ",1),l.description?(d(),u("span",Se," â€¢ "+m(l.description),1)):R("",!0)])]),a("div",Be,[t(x,{flat:"",dense:"",round:"",size:"sm",icon:"edit",color:"grey-6",onClick:F=>E(l)},{default:i(()=>[t(J,null,{default:i(()=>[...s[9]||(s[9]=[k("Edit",-1)])]),_:1})]),_:2},1032,["onClick"]),t(x,{flat:"",dense:"",round:"",size:"sm",icon:"delete",color:"grey-6",onClick:F=>M(l)},{default:i(()=>[t(J,null,{default:i(()=>[...s[10]||(s[10]=[k("Delete",-1)])]),_:1})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1}),t(Z,{modelValue:D.value,"onUpdate:modelValue":s[3]||(s[3]=l=>D.value=l)},{default:i(()=>[t(z,{style:{"min-width":"400px"}},{default:i(()=>[t(T,null,{default:i(()=>[a("div",Ne,m(o.value?"Edit Relationship":"Add Relationship"),1)]),_:1}),t(T,{class:"q-pt-none"},{default:i(()=>[a("div",Ue,[t(se,{modelValue:g.selectedPerson,"onUpdate:modelValue":s[0]||(s[0]=l=>g.selectedPerson=l),options:L.value,"option-label":"name","option-value":"id",label:"Person *",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",clearable:"",autofocus:"","emit-value":"","map-options":"",onFilter:Y,onPopupShow:j,rules:[l=>!!l||"Person is required"]},{"no-option":i(()=>[t(_e,null,{default:i(()=>[t(we,{class:"text-grey"},{default:i(()=>[k(m(L.value.length===0?"Loading people...":"No people found"),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"]),t(se,{modelValue:g.relationshipType,"onUpdate:modelValue":s[1]||(s[1]=l=>g.relationshipType=l),options:B.value,label:"Relationship Type *",filled:"","emit-value":"","map-options":"",rules:[l=>!!l||"Relationship type is required"]},null,8,["modelValue","options","rules"]),t(ve,{modelValue:g.description,"onUpdate:modelValue":s[2]||(s[2]=l=>g.description=l),label:"Description",hint:"e.g., 'college roommate', 'sister-in-law'",filled:"",autocomplete:"off"},null,8,["modelValue"])])]),_:1}),t(ee,{align:"right"},{default:i(()=>[t(x,{flat:"",label:"Cancel",color:"grey-7",onClick:n}),t(x,{flat:"",label:o.value?"Save Changes":"Add Relationship",color:"primary",loading:P.value,onClick:K},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Z,{modelValue:h.value,"onUpdate:modelValue":s[5]||(s[5]=l=>h.value=l)},{default:i(()=>[t(z,null,{default:i(()=>[t(T,{class:"row items-center"},{default:i(()=>[t(te,{icon:"warning",color:"negative","text-color":"white"}),a("span",Me,[s[11]||(s[11]=k(" Are you sure you want to delete the relationship with ",-1)),a("strong",null,m(b.value?.person1_name===r.personName?b.value?.person2_name:b.value?.person1_name),1),s[12]||(s[12]=k("? ",-1))])]),_:1}),t(ee,{align:"between"},{default:i(()=>[t(x,{flat:"",label:"Cancel",color:"grey-7",onClick:s[4]||(s[4]=l=>h.value=!1)}),t(x,{flat:"",label:"Delete",color:"negative",onClick:G})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},He=ae(Oe,[["__scopeId","data-v-2e32aae6"]]),Ye={key:0,class:"text-center q-pa-xl"},je={key:1,class:"text-center q-pa-xl"},Je={class:"text-h6 text-negative q-mt-md"},Ke={key:2,class:"text-center q-pa-xl"},Ge={key:3,class:"person-detail-container"},We={class:"breadcrumb-nav q-mb-md"},Xe={class:"row items-start q-gutter-md"},Ze={class:"col"},et={class:"text-h4 q-mb-sm text-weight-medium"},tt={key:0,class:"text-h6 text-grey-7 q-mb-md"},ot={class:"text-body2 text-grey-6"},st={key:0},at={class:"col-auto"},lt={class:"action-buttons"},nt={class:"row q-col-gutter-lg"},it={class:"col-12 col-md-6"},rt={key:0,class:"contact-item q-mb-md"},dt={class:"row items-center q-gutter-sm"},ct={class:"col text-body1"},ut={key:1,class:"contact-item q-mb-md"},pt={class:"row items-center q-gutter-sm"},mt={class:"col text-body1"},vt={key:2,class:"contact-item q-mb-md"},yt={class:"row items-center q-gutter-sm"},ft={class:"col text-body1"},ht={key:3,class:"contact-item q-mb-md"},gt={class:"row items-center q-gutter-sm"},_t={class:"col"},wt={class:"text-body1"},xt={key:4,class:"contact-item q-mb-md"},bt={class:"row items-center q-gutter-sm"},qt={class:"col"},Ct={key:5,class:"contact-item"},kt={class:"row items-start q-gutter-sm"},Rt={class:"col q-ml-sm"},Pt={class:"text-body2 text-grey-7"},Dt={class:"text-body1 text-grey-8 pre-line"},$t={class:"col-12 col-md-6"},Ft={class:"text-body1 text-grey-8 pre-line ai-summary-text"},Tt={key:0,class:"text-center q-pa-md"},Vt={key:1,class:"text-center q-pa-md"},Lt={key:2,class:"conversations-scroll-container"},zt=["onClick"],Qt={class:"row items-start q-gutter-sm"},At={class:"col"},It={class:"text-body2 text-weight-medium q-mb-xs"},Et={key:0},St={class:"text-caption text-grey-6 q-mb-xs"},Bt={class:"text-body2 text-grey-7 conversation-preview"},Nt={key:0,class:"q-mt-sm text-warning"},Ut={class:"q-ml-sm"},Mt={__name:"PersonDetailView",setup(r){const p=ye(),v=fe(),_=de(),y=ce(),I=Re(),V=C(!1),P=C(!1),D=C(!1),h=C([]),o=A(()=>y.selectedPerson),b=async()=>{const n=p.params.id;if(n)try{await y.fetchPersonById(n),await L()}catch(e){console.error("Failed to load person:",e)}},L=async()=>{if(o.value){D.value=!0,h.value=[];try{const n=await I.fetchConversationsForPerson(o.value.id);h.value=n||[]}catch(n){console.error("Failed to load conversations:",n),h.value=[]}finally{D.value=!1}}},g=()=>{v.push({name:"people"})},B=()=>{o.value&&v.push({name:"person-edit",params:{id:o.value.id}})},N=async()=>{if(o.value)try{const n=o.value.name;await y.deletePerson(o.value.id),P.value=!1,_.notify({type:"positive",message:`${n} deleted successfully`,position:"top",timeout:4e3,actions:[{icon:"close",color:"white",dense:!0}]}),v.push({name:"people"})}catch(n){console.error("Failed to delete person:",n),_.notify({type:"negative",message:"Failed to delete person. Please try again.",position:"top",timeout:4e3})}},U=async()=>{if(o.value?.email)try{await navigator.clipboard.writeText(o.value.email),_.notify({type:"positive",message:`Email copied: ${o.value.email}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(n){console.error("Failed to copy email:",n),_.notify({type:"negative",message:"Failed to copy email address",position:"top",timeout:3e3})}},Y=async()=>{if(o.value?.phone)try{await navigator.clipboard.writeText(o.value.phone),_.notify({type:"positive",message:`Phone number copied: ${o.value.phone}`,position:"top",timeout:3e3,actions:[{icon:"close",color:"white",dense:!0}]})}catch(n){console.error("Failed to copy phone number:",n),_.notify({type:"negative",message:"Failed to copy phone number",position:"top",timeout:3e3})}},f=()=>{o.value&&v.push({name:"conversation-create",query:{participants:o.value.id}})},c=()=>{o.value&&v.push({name:"contact-attempt-create",query:{person:o.value.id}})},$=n=>{if(!n)return"Never";const e=new Date(n),w=new Date-e,l=Math.floor(w/(1e3*60*60*24));if(l===0)return"Today";if(l===1)return"Yesterday";if(l<7)return l===1?"1 day ago":`${l} days ago`;if(l<30){const F=Math.floor(l/7);return F===1?"1 week ago":`${F} weeks ago`}if(l<365){const F=Math.floor(l/30);return F===1?"1 month ago":`${F} months ago`}return e.toLocaleDateString()},E=n=>n?new Date(n).toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}):"",M=n=>{if(!n)return"";const e=new Date(n),w=new Date-e,l=Math.floor(w/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:e.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})},K=(n,e)=>!n||n.length<=e?n:n.substring(0,e).trim()+"...",G=n=>{v.push({name:"conversation-detail",params:{id:n.id}})},W=n=>{if(!n)return"grey-6";const e=new Date(n),w=new Date-e,l=Math.floor(w/(1e3*60*60*24));return l<=60?"positive":l<=180?"grey-7":"negative"},j=n=>{if(!n)return"text-grey-6";const e=new Date(n),w=new Date-e,l=Math.floor(w/(1e3*60*60*24));return l<=60?"text-positive":l<=180?"text-grey-8":"text-negative"};return le(()=>p.params.id,(n,e)=>{n&&n!==e&&(h.value=[],b())}),ne(()=>{b()}),(n,e)=>(d(),O(xe,{view:"lHh Lpr lFf"},{default:i(()=>[t(be,{onToggleDrawer:e[0]||(e[0]=s=>V.value=!V.value)}),t(qe,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=s=>V.value=s)},null,8,["modelValue"]),t(Ce,null,{default:i(()=>[t(ke,{class:"q-pa-md",style:{"background-color":"#f8f9fa"}},{default:i(()=>[S(y).isLoading?(d(),u("div",Ye,[t(X,{size:"50px",color:"primary"}),e[5]||(e[5]=a("div",{class:"q-mt-md"},"Loading person details...",-1))])):S(y).hasError?(d(),u("div",je,[t(q,{name:"error_outline",size:"80px",color:"negative"}),a("div",Je,m(S(y).error),1),t(x,{color:"primary",label:"Try Again",class:"q-mt-md",onClick:b})])):o.value?(d(),u("div",Ge,[a("div",We,[t(ge,{class:"text-grey-6"},{default:i(()=>[t(oe,{icon:"people",label:"People",onClick:g,class:"cursor-pointer"}),t(oe,{label:o.value.name},null,8,["label"])]),_:1})]),t(z,{class:"header-card q-mb-lg",flat:""},{default:i(()=>[t(T,{class:"q-pa-lg"},{default:i(()=>[a("div",Xe,[a("div",Ze,[a("div",et,m(o.value.name),1),o.value.name_ext?(d(),u("div",tt,m(o.value.name_ext),1)):R("",!0),a("div",ot,[t(q,{name:"schedule",size:"16px",class:"q-mr-xs"}),k(" Added "+m($(o.value.created_at))+" ",1),o.value.created_by_username?(d(),u("span",st," by "+m(o.value.created_by_username),1)):R("",!0)])]),a("div",at,[a("div",lt,[t(x,{color:"secondary",icon:"chat_bubble",label:"Log Conversation",class:"q-mr-sm",onClick:f}),t(x,{outline:"",color:"secondary",icon:"contact_phone",label:"Ping",class:"q-mr-sm",onClick:c}),t(x,{outline:"",color:"primary",icon:"edit",label:"Edit",class:"q-mr-sm",onClick:B}),t(x,{outline:"",color:"negative",icon:"delete",label:"Delete",onClick:e[2]||(e[2]=s=>P.value=!0)})])])])]),_:1})]),_:1}),a("div",nt,[a("div",it,[t(z,{class:"content-card q-mb-lg",flat:"",bordered:""},{default:i(()=>[t(T,{class:"q-pa-lg"},{default:i(()=>[e[11]||(e[11]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Contact Information",-1)),o.value.location?(d(),u("div",rt,[a("div",dt,[t(q,{name:"place",size:"20px",color:"grey-7"}),a("div",ct,m(o.value.location),1)])])):R("",!0),o.value.email?(d(),u("div",ut,[a("div",pt,[t(q,{name:"email",size:"20px",color:"grey-7"}),a("div",mt,m(o.value.email),1),t(x,{unelevated:"",size:"sm",icon:"content_copy",color:"info","text-color":"white",onClick:U,class:"contact-action-btn"},{default:i(()=>[t(J,null,{default:i(()=>[...e[7]||(e[7]=[k("Copy Email",-1)])]),_:1})]),_:1})])])):R("",!0),o.value.phone?(d(),u("div",vt,[a("div",yt,[t(q,{name:"phone",size:"20px",color:"grey-7"}),a("div",ft,m(o.value.phone),1),t(x,{unelevated:"",size:"sm",icon:"content_copy",color:"info","text-color":"white",onClick:Y,class:"contact-action-btn"},{default:i(()=>[t(J,null,{default:i(()=>[...e[8]||(e[8]=[k("Copy Phone",-1)])]),_:1})]),_:1})])])):R("",!0),o.value.birthday?(d(),u("div",ht,[a("div",gt,[t(q,{name:"cake",size:"20px",color:"grey-7"}),a("div",_t,[a("div",wt,m(E(o.value.birthday)),1),e[9]||(e[9]=a("div",{class:"text-caption text-grey-6"},"Birthday",-1))])])])):R("",!0),o.value.last_contacted?(d(),u("div",xt,[a("div",bt,[t(q,{name:"schedule",size:"20px",color:W(o.value.last_contacted)},null,8,["color"]),a("div",qt,[a("div",{class:he(["text-body1",j(o.value.last_contacted)])},m($(o.value.last_contacted)),3),e[10]||(e[10]=a("div",{class:"text-caption text-grey-6"},"Last Contact",-1))])])])):R("",!0),o.value.how_we_met?(d(),u("div",Ct,[a("div",kt,[t(q,{name:"handshake",size:"18px",color:"grey-6"}),a("div",Rt,[a("div",Pt,m(o.value.how_we_met),1)])])])):R("",!0)]),_:1})]),_:1}),o.value.notes?(d(),O(z,{key:0,class:"content-card q-mb-lg",flat:"",bordered:""},{default:i(()=>[t(T,{class:"q-pa-lg"},{default:i(()=>[e[12]||(e[12]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Notes",-1)),a("div",Dt,m(o.value.notes),1)]),_:1})]),_:1})):R("",!0),(d(),O(He,{key:o.value.id,"person-id":o.value.id,"person-name":o.value.name},null,8,["person-id","person-name"]))]),a("div",$t,[o.value.ai_summary?(d(),O(z,{key:0,class:"content-card q-mb-lg",flat:"",bordered:""},{default:i(()=>[t(T,{class:"q-pa-lg"},{default:i(()=>[e[13]||(e[13]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Conversation History",-1)),a("div",Ft,m(o.value.ai_summary),1)]),_:1})]),_:1})):R("",!0),t(z,{class:"content-card q-mb-lg",flat:"",bordered:""},{default:i(()=>[t(T,{class:"q-pa-lg"},{default:i(()=>[e[17]||(e[17]=a("div",{class:"text-h6 q-mb-md text-weight-medium"},"Conversations",-1)),D.value?(d(),u("div",Tt,[t(X,{size:"20px",color:"primary"}),e[14]||(e[14]=a("div",{class:"text-caption text-grey-6 q-mt-sm"},"Loading conversations...",-1))])):h.value.length===0?(d(),u("div",Vt,[t(q,{name:"chat_bubble_outline",size:"32px",color:"grey-4"}),e[15]||(e[15]=a("div",{class:"text-body2 text-grey-6 q-mt-sm"},"No conversations recorded yet",-1))])):(d(),u("div",Lt,[(d(!0),u(ie,null,re(h.value,s=>(d(),u("div",{key:s.id,class:"conversation-timeline-item q-mb-sm cursor-pointer",onClick:w=>G(s)},[a("div",Qt,[t(te,{size:"32px",color:S(Pe)(s.type),"text-color":"white"},{default:i(()=>[t(q,{name:S(De)(s.type),size:"16px"},null,8,["name"])]),_:2},1032,["color"]),a("div",At,[a("div",It,[k(m(S($e)(s.type))+" ",1),s.location?(d(),u("span",Et," â€¢ "+m(s.location),1)):R("",!0)]),a("div",St,m(M(s.date)),1),a("div",Bt,m(K(s.notes,150)),1),s.private?(d(),u("div",Nt,[t(q,{name:"lock",class:"q-mb-xs"}),e[16]||(e[16]=k(" Private to you ",-1))])):R("",!0)]),t(q,{name:"chevron_right",color:"grey-4",size:"16px"})])],8,zt))),128))]))]),_:1})]),_:1})])])])):(d(),u("div",Ke,[t(q,{name:"person_off",size:"80px",color:"grey-5"}),e[6]||(e[6]=a("div",{class:"text-h6 text-grey-7 q-mt-md"}," Person not found ",-1)),t(x,{color:"primary",label:"Back to People",class:"q-mt-md",onClick:g})])),t(Z,{modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=s=>P.value=s)},{default:i(()=>[t(z,null,{default:i(()=>[t(T,{class:"row items-center"},{default:i(()=>[t(te,{icon:"warning",color:"negative","text-color":"white"}),a("span",Ut,[e[18]||(e[18]=k(" Are you sure you want to delete ",-1)),a("strong",null,m(o.value?.name),1),e[19]||(e[19]=k("? This action cannot be undone. ",-1))])]),_:1}),t(ee,{align:"between"},{default:i(()=>[t(x,{flat:"",label:"Cancel",color:"grey-7",onClick:e[3]||(e[3]=s=>P.value=!1)}),t(x,{flat:"",label:"Delete",color:"negative",onClick:N})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},eo=ae(Mt,[["__scopeId","data-v-c2d7f9ce"]]);export{eo as default};
