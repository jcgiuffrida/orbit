import{_ as L,c as P,r as z,a as r,o as l,b as t,d as k,e as W,f as x,g as N,w as e,Q as O,h as o,i as B,t as i,j as y,k as m,l as h,m as d,n as w,F as q,p as Q,q as $}from"./main-DJ_tSYHB.js";import{Q as C}from"./QItemLabel-BRFh0h6K.js";import{_ as T,a as F,Q as I,b as R,c as D,d as S,e as V,f as M}from"./NavigationDrawer-CSW2CacQ.js";const H={class:"monthly-chart"},j={key:0,class:"text-body2 text-grey-6 text-center q-pa-lg"},E={key:1},U={__name:"WeeklyActivityChart",props:{data:{type:Array,default:()=>[]}},setup(b){const c=b,n=P(()=>{if(!c.data||c.data.length===0)return{};const p=c.data.map(u=>u.month_name),_=c.data.map(u=>u.conversations),f=c.data.map(u=>u.contact_attempts);return{chart:{type:"line",backgroundColor:"transparent",spacingTop:20,spacingBottom:20,spacingLeft:20,spacingRight:20},title:{text:null},xAxis:{categories:p,lineColor:"#e0e0e0",tickColor:"#e0e0e0",labels:{style:{color:"#666",fontSize:"12px"}}},yAxis:{title:{text:"Count",style:{color:"#666"}},min:0,gridLineColor:"#f0f0f0",labels:{style:{color:"#666",fontSize:"12px"}}},tooltip:{backgroundColor:"#ffffff",borderColor:"#e0e0e0",borderRadius:8,shadow:!0,useHTML:!0,formatter:function(){let u=`<div style="text-align: center; margin-bottom: 5px;"><b>${this.x}</b></div>`;return this.points.forEach(g=>{u+=`<div><span style="color:${g.color}">‚óè</span> ${g.series.name}: <b>${g.y}</b></div>`}),u}},legend:{align:"center",verticalAlign:"bottom",borderWidth:0,itemStyle:{color:"#666",fontSize:"12px"}},plotOptions:{line:{marker:{enabled:!0,radius:4,lineWidth:2,lineColor:"#ffffff"},lineWidth:3,states:{hover:{lineWidth:4}}}},series:[{name:"Conversations",data:_,color:"#1976d2",marker:{fillColor:"#1976d2"}},{name:"Contact Attempts",data:f,color:"#424242",marker:{fillColor:"#424242"}}],credits:{enabled:!1},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"},xAxis:{labels:{rotation:-45,style:{fontSize:"10px"}}}}}]}}});return(p,_)=>{const f=z("highcharts");return l(),r("div",H,[!b.data||b.data.length===0?(l(),r("div",j," No activity data available ")):(l(),r("div",E,[t(f,{options:n.value,style:{height:"400px",width:"100%"}},null,8,["options"])]))])}}},Y=L(U,[["__scopeId","data-v-1ca99efb"]]),G={key:0,class:"flex flex-center q-mt-lg"},J={key:1,class:"text-center q-mt-lg"},K={class:"text-body2"},X={key:2},Z={class:"row items-center q-mb-lg"},tt={class:"col-auto"},et={class:"q-gutter-sm"},at={class:"row q-mb-lg"},ot={class:"col-12"},st={class:"row q-mb-lg"},lt={class:"col-12"},nt={class:"row q-col-gutter-md"},it={class:"col"},rt={class:"text-h6"},dt={key:0,class:"text-body2"},ct={class:"col"},ut={class:"text-h6"},vt={key:0,class:"text-body2"},_t={class:"col"},mt={class:"text-h6"},pt={key:0,class:"text-body2"},ft={class:"row q-col-gutter-md q-mb-lg"},yt={class:"col-12 col-md-6"},ht={class:"col-12 col-md-6"},gt={class:"row"},xt={class:"col-12"},bt={class:"row q-col-gutter-md"},kt={class:"text-h6"},wt={key:0,class:"text-caption text-grey-6"},At={__name:"HomeView",setup(b){const c=k(!1),n=k({}),p=k(!0),_=k(null),f=async()=>{try{p.value=!0,_.value=null;const v=await N.get("/dashboard/");n.value=v.data}catch(v){_.value=v.response?.data?.detail||"Failed to load dashboard data",console.error("Dashboard load error:",v)}finally{p.value=!1}},u=v=>new Date(v).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),g=(v,a,s)=>v===1?a:s;return W(()=>{f()}),(v,a)=>(l(),x(M,{view:"lHh Lpr lFf"},{default:e(()=>[t(T,{onToggleDrawer:a[0]||(a[0]=s=>c.value=!c.value)}),t(F,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=s=>c.value=s)},null,8,["modelValue"]),t(I,null,{default:e(()=>[t(R,{class:"q-pa-md"},{default:e(()=>[p.value?(l(),r("div",G,[t(O,{size:"2em"})])):_.value?(l(),r("div",J,[t(B,{name:"error",size:"2em",color:"negative"}),a[3]||(a[3]=o("div",{class:"text-h6 q-mt-md"},"Failed to load dashboard",-1)),o("div",K,i(_.value),1),t(y,{onClick:f,color:"primary",class:"q-mt-md"},{default:e(()=>[...a[2]||(a[2]=[m("Retry",-1)])]),_:1})])):(l(),r("div",X,[o("div",Z,[a[4]||(a[4]=o("div",{class:"col"},[o("h1",{class:"text-h4 q-ma-none"},"Dashboard")],-1)),o("div",tt,[o("div",et,[t(y,{color:"primary",icon:"add_comment",to:{name:"conversation-create"},label:"New Conversation"}),t(y,{color:"secondary",icon:"contact_phone",to:{name:"contact-attempt-create"},label:"New Ping"}),t(y,{color:"accent",icon:"person_add",to:{name:"person-create"},label:"Add Person"})])])]),o("div",at,[o("div",ot,[t(h,null,{default:e(()=>[t(d,null,{default:e(()=>[...a[5]||(a[5]=[o("div",{class:"text-h6"},"Activity Over Past 6 Months",-1)])]),_:1}),t(d,null,{default:e(()=>[t(Y,{data:n.value.monthly_activity},null,8,["data"])]),_:1})]),_:1})])]),o("div",st,[o("div",lt,[t(h,null,{default:e(()=>[t(d,null,{default:e(()=>[...a[6]||(a[6]=[o("div",{class:"text-h6"},"Activity Overview",-1)])]),_:1}),t(d,null,{default:e(()=>[o("div",nt,[o("div",it,[a[7]||(a[7]=o("div",{class:"text-caption"},"Past Week",-1)),o("div",rt,i(n.value.activity_overview.conversations.week)+" conversations",1),n.value.activity_overview.contact_attempts.week>0?(l(),r("div",dt,"+ "+i(n.value.activity_overview.contact_attempts.week)+" contact attempts",1)):w("",!0)]),o("div",ct,[a[8]||(a[8]=o("div",{class:"text-caption"},"Past Month",-1)),o("div",ut,i(n.value.activity_overview.conversations.month)+" conversations",1),n.value.activity_overview.contact_attempts.month>0?(l(),r("div",vt,"+ "+i(n.value.activity_overview.contact_attempts.month)+" contact attempts",1)):w("",!0)]),o("div",_t,[a[9]||(a[9]=o("div",{class:"text-caption"},"Past Year",-1)),o("div",mt,i(n.value.activity_overview.conversations.year)+" conversations",1),n.value.activity_overview.contact_attempts.year>0?(l(),r("div",pt,"+ "+i(n.value.activity_overview.contact_attempts.year)+" contact attempts",1)):w("",!0)])])]),_:1})]),_:1})])]),o("div",ft,[o("div",yt,[t(h,null,{default:e(()=>[t(d,null,{default:e(()=>[...a[10]||(a[10]=[o("div",{class:"text-h6"},"Recent Conversations",-1)])]),_:1}),t(d,null,{default:e(()=>[t(D,{separator:""},{default:e(()=>[(l(!0),r(q,null,Q(n.value.recent_conversations.slice(0,5),s=>(l(),x(S,{key:s.id,to:{name:"conversation-detail",params:{id:s.id}},clickable:""},{default:e(()=>[t(V,null,{default:e(()=>[t(C,null,{default:e(()=>[m(i(u(s.date)),1)]),_:2},1024),t(C,{caption:""},{default:e(()=>[m(i(s.participants.map(A=>A.name).join(", ")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1}),t($,{align:"center"},{default:e(()=>[t(y,{flat:"",to:{name:"conversations"}},{default:e(()=>[...a[11]||(a[11]=[m("View all",-1)])]),_:1})]),_:1})]),_:1})]),o("div",ht,[t(h,null,{default:e(()=>[t(d,null,{default:e(()=>[...a[12]||(a[12]=[o("div",{class:"text-h6"},"Top Contacts (1-2 yrs)",-1)])]),_:1}),t(d,null,{default:e(()=>[t(D,{separator:""},{default:e(()=>[(l(!0),r(q,null,Q(n.value.top_contacts.slice(0,5),s=>(l(),x(S,{key:s.id,to:{name:"person-detail",params:{id:s.id}},clickable:""},{default:e(()=>[t(V,null,{default:e(()=>[t(C,null,{default:e(()=>[m(i(s.name),1)]),_:2},1024),t(C,{caption:""},{default:e(()=>[m(i(s.conversation_count_recent)+" "+i(g(s.conversation_count_recent,"conversation","conversations")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1}),t($,{align:"center"},{default:e(()=>[t(y,{flat:"",to:{name:"people"}},{default:e(()=>[...a[13]||(a[13]=[m("View all",-1)])]),_:1})]),_:1})]),_:1})])]),o("div",gt,[o("div",xt,[t(h,null,{default:e(()=>[t(d,null,{default:e(()=>[...a[14]||(a[14]=[o("div",{class:"text-h6"},"People to Reach Out",-1)])]),_:1}),n.value.people_to_reach_out.length===0?(l(),x(d,{key:0},{default:e(()=>[...a[15]||(a[15]=[o("div",{class:"text-body2 text-grey-6"},"Great! You're up to date with everyone.",-1)])]),_:1})):(l(),x(d,{key:1},{default:e(()=>[o("div",bt,[(l(!0),r(q,null,Q(n.value.people_to_reach_out,s=>(l(),r("div",{key:s.id,class:"col-12 col-sm-6 col-md-4"},[t(h,{class:"cursor-pointer",onClick:A=>v.$router.push({name:"person-detail",params:{id:s.id}})},{default:e(()=>[t(d,null,{default:e(()=>[o("div",kt,i(s.name),1),s.days_since_last_contact?(l(),r("div",wt,i(s.days_since_last_contact)+" days ago ",1)):w("",!0)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])]),_:1}))]),_:1})])])]))]),_:1})]),_:1})]),_:1}))}};export{At as default};
